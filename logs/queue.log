[2025-05-10T04:24:58.978Z] [INFO] 🏁 Job started processing: contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:24:58.983Z] [INFO] 🏁 Job started processing: contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:24:58.979Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:24:58.981Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:24:58.982Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 active
[2025-05-10T04:24:58.983Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:24:58.986Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:24:58.986Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 active
[2025-05-10T04:24:59.110Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:24:59.111Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=true
[2025-05-10T04:24:59.111Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:24:59.118Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:24:59.118Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=true
[2025-05-10T04:24:59.118Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:25:00.213Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:25:00.215Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:25:00.217Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:25:00.218Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:25:00.236Z] [ERROR] Contribution cycle failed for group cmahne9400003rczuj9f1fclj: Error: socket hang up
[2025-05-10T04:25:00.242Z] [ERROR] Contribution cycle failed for group cmahne9400003rczuj9f1fclj: Error: socket hang up
[2025-05-10T04:25:00.266Z] [ERROR] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 failed: Error: socket hang up
[2025-05-10T04:25:00.271Z] [ERROR] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 failed: Error: socket hang up
[2025-05-10T04:25:04.936Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:25:04.936Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:25:04.937Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:25:04.938Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:25:04.941Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:25:04.941Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:25:05.268Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 waiting
[2025-05-10T04:25:05.298Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 waiting
[2025-05-10T04:25:05.307Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:25:05.319Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:25:05.545Z] [INFO] Redis bclient connected
[2025-05-10T04:25:05.545Z] [INFO] Redis bclient ready
[2025-05-10T04:25:05.545Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:25:05.567Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:25:05.569Z] [INFO] Redis bclient connected
[2025-05-10T04:25:05.569Z] [INFO] Redis bclient ready
[2025-05-10T04:25:05.570Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:25:05.570Z] [INFO] Redis bclient connected
[2025-05-10T04:25:05.570Z] [INFO] Redis bclient ready
[2025-05-10T04:25:05.571Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:25:05.594Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:25:05.594Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:25:05.960Z] [INFO] Redis bclient connected
[2025-05-10T04:25:05.960Z] [INFO] Redis bclient ready
[2025-05-10T04:25:05.960Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:25:05.986Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:32:44.531Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:32:44.531Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:32:44.531Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:32:44.531Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:32:44.531Z] [INFO] Node Environment: development
[2025-05-10T04:32:44.532Z] [INFO] Hostname: 20fc79270cc0
[2025-05-10T04:32:44.532Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:32:44.532Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:32:44.532Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:32:44.532Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:32:44.533Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:32:44.533Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:32:44.568Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:32:44.568Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:32:44.568Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:32:44.627Z] [INFO] Redis subscriber connected
[2025-05-10T04:32:44.627Z] [INFO] Redis subscriber ready
[2025-05-10T04:32:44.630Z] [INFO] Redis bclient connected
[2025-05-10T04:32:44.630Z] [INFO] Redis bclient ready
[2025-05-10T04:32:44.633Z] [INFO] Redis client connected
[2025-05-10T04:32:44.633Z] [INFO] Redis client ready
[2025-05-10T04:32:44.602Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:32:44.602Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:32:44.603Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:32:44.603Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:32:44.603Z] [INFO] Node Environment: development
[2025-05-10T04:32:44.603Z] [INFO] Hostname: 8d8ca6dd84fb
[2025-05-10T04:32:44.604Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:32:44.604Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:32:44.604Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:32:44.604Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:32:44.604Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:32:44.604Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:32:44.639Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:32:44.639Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:32:44.639Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:32:44.662Z] [INFO] ✓ Redis client connected
[2025-05-10T04:32:44.659Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:32:44.659Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:32:44.659Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:32:44.659Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:32:44.659Z] [INFO] Node Environment: development
[2025-05-10T04:32:44.659Z] [INFO] Hostname: 5e378c79d068
[2025-05-10T04:32:44.660Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:32:44.660Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:32:44.660Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:32:44.660Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:32:44.660Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:32:44.660Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:32:44.694Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:32:44.694Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:32:44.694Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:32:44.698Z] [INFO] Redis client connected
[2025-05-10T04:32:44.699Z] [INFO] Redis client ready
[2025-05-10T04:32:44.701Z] [INFO] Redis subscriber connected
[2025-05-10T04:32:44.702Z] [INFO] Redis subscriber ready
[2025-05-10T04:32:44.705Z] [INFO] Redis bclient connected
[2025-05-10T04:32:44.705Z] [INFO] Redis bclient ready
[2025-05-10T04:32:44.715Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:32:44.715Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:32:44.716Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:32:44.716Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:32:44.687Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:32:44.687Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:32:44.687Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:32:44.688Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:32:44.688Z] [INFO] Node Environment: development
[2025-05-10T04:32:44.688Z] [INFO] Hostname: d635bced76f3
[2025-05-10T04:32:44.689Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:32:44.689Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:32:44.689Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:32:44.689Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:32:44.689Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:32:44.689Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:32:44.722Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:32:44.723Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:32:44.723Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:32:44.726Z] [INFO] ✓ Redis client connected
[2025-05-10T04:32:44.748Z] [INFO] Redis client connected
[2025-05-10T04:32:44.748Z] [INFO] Redis client ready
[2025-05-10T04:32:44.751Z] [INFO] Redis subscriber connected
[2025-05-10T04:32:44.751Z] [INFO] Redis subscriber ready
[2025-05-10T04:32:44.755Z] [INFO] Redis bclient connected
[2025-05-10T04:32:44.755Z] [INFO] Redis bclient ready
[2025-05-10T04:32:44.768Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:32:44.769Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:32:44.769Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:32:44.769Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:32:44.773Z] [INFO] ✓ Redis client connected
[2025-05-10T04:32:44.778Z] [INFO] Redis client connected
[2025-05-10T04:32:44.778Z] [INFO] Redis client ready
[2025-05-10T04:32:44.780Z] [INFO] Redis bclient connected
[2025-05-10T04:32:44.780Z] [INFO] Redis bclient ready
[2025-05-10T04:32:44.782Z] [INFO] Redis subscriber connected
[2025-05-10T04:32:44.783Z] [INFO] Redis subscriber ready
[2025-05-10T04:32:44.797Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:32:44.797Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:32:44.798Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:32:44.807Z] [INFO] ✓ Redis client connected
[2025-05-10T04:32:44.820Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:32:44.821Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:32:44.821Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:32:44.821Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:32:44.852Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:32:44.852Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:32:44.852Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:32:44.856Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:32:44.856Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:32:44.856Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:32:44.856Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:32:44.892Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:32:44.892Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:32:44.892Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:32:44.918Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:32:44.918Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:32:44.918Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:32:44.942Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:32:44.944Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:32:44.942Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:32:44.942Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:32:44.944Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:32:44.944Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:32:44.978Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:32:44.979Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:32:44.979Z] [INFO] ✓ All queues operational
[2025-05-10T04:32:44.979Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:32:44.979Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:32:44.980Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:32:44.980Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:32:44.980Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:32:44.987Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:32:44.987Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:32:44.987Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:32:45.020Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:32:45.020Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:32:45.020Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:32:45.021Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:32:45.020Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:32:45.020Z] [INFO] ✓ All queues operational
[2025-05-10T04:32:45.020Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:32:45.020Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:32:45.021Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:32:45.021Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:32:45.022Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:32:45.047Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:32:45.047Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:32:45.047Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:32:45.047Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:32:45.048Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:32:45.048Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:32:45.048Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:32:45.070Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:32:45.070Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:32:45.070Z] [INFO] ✓ All queues operational
[2025-05-10T04:32:45.070Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:32:45.070Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:32:45.070Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:32:45.070Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:32:45.071Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:32:45.078Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:32:45.078Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:32:45.079Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:32:45.079Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:32:45.082Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:32:45.083Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:32:45.083Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:32:45.097Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:32:45.098Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:32:45.098Z] [INFO] ✓ All queues operational
[2025-05-10T04:32:45.098Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:32:45.098Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:32:45.099Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:32:45.099Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:32:45.100Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:32:45.130Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:32:45.130Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:32:45.130Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:32:45.130Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:32:45.130Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:32:45.131Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:32:45.131Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:32:45.159Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:32:45.160Z] [INFO] 🔍 Checking for stuck jobs in all queues...
[2025-05-10T04:32:45.188Z] [INFO] 🏁 Job started processing: contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:32:45.189Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:32:45.189Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:32:45.189Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 active
[2025-05-10T04:32:45.214Z] [INFO] Found 3 total jobs across all queues
[2025-05-10T04:32:45.214Z] [INFO] Found 1 potentially stuck jobs
[2025-05-10T04:32:45.214Z] [INFO] Attempting to reprocess stuck job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 (queue: contribution-cycles)
[2025-05-10T04:32:45.267Z] [ERROR] Failed to reprocess stuck job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494: Error: Couldn't retry job: The job has been already retried or has not failed
[2025-05-10T04:32:45.267Z] [INFO] ✅ Recovery check complete: 0/1 stuck jobs reprocessed
[2025-05-10T04:32:45.267Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:32:45.267Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:32:45.267Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:32:45.267Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:32:45.268Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:32:45.268Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:32:45.311Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:32:45.323Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:32:45.336Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:32:45.345Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:32:45.373Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:32:45.395Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:32:45.469Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:32:45.491Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:32:45.494Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:32:45.508Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:32:45.513Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:32:45.513Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:32:45.531Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:32:45.538Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:32:45.541Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:32:45.542Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:32:45.542Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=false
[2025-05-10T04:32:45.542Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:32:45.561Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:32:45.564Z] [INFO] Removing 1 existing contribution jobs to prevent duplicates
[2025-05-10T04:32:45.578Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:32:45.586Z] [INFO] Removing 1 existing contribution jobs to prevent duplicates
[2025-05-10T04:32:45.591Z] [INFO] Processing recovery for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:32:45.591Z] [INFO] Group cm7a5zl550003rcnc7jnt7bnb:  [object Object]
[2025-05-10T04:32:45.607Z] [INFO] Processing recovery for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:32:45.607Z] [INFO] Group cm7a5zl550003rcnc7jnt7bnb:  [object Object]
[2025-05-10T04:32:45.621Z] [INFO] Processing recovery for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:32:45.621Z] [INFO] Group cm7a5zl550003rcnc7jnt7bnb:  [object Object]
[2025-05-10T04:32:45.667Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:32:45.673Z] [INFO] ✅ Successfully recovered cycle job for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.673Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:32:45.673Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:32:45.673Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:32:45.674Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:32:45.682Z] [INFO] ✅ Successfully recovered cycle job for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.682Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:32:45.682Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:32:45.683Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:32:45.683Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:32:45.689Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:32:45.699Z] [INFO] ✅ Successfully recovered cycle job for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.699Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:32:45.699Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:32:45.699Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:32:45.699Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:32:45.707Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:32:45.728Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:32:45.729Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:32:45.729Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:32:45.729Z] [INFO] 🔁 Attempting to schedule next cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.730Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:32:45.730Z] [INFO] 🔁 Attempting to schedule next cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.750Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:32:45.751Z] [INFO] Removing 3 existing contribution jobs to prevent duplicates
[2025-05-10T04:32:45.751Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:32:45.751Z] [INFO] 🔁 Attempting to schedule next cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.778Z] [INFO] Processing recovery for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:32:45.778Z] [INFO] Group cm7a5zl550003rcnc7jnt7bnb:  [object Object]
[2025-05-10T04:32:45.806Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:32:45.807Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:32:45.806Z] [INFO] ✅ Validations passed, proceeding to schedule group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.807Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:32:45.807Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.807Z] [INFO] 🔄 Starting schedule process for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.807Z] [INFO] ✅ Validations passed, proceeding to schedule group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.808Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:32:45.808Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.808Z] [INFO] 🔄 Starting schedule process for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.831Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:32:45.831Z] [INFO] ✅ Validations passed, proceeding to schedule group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.831Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:32:45.831Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.831Z] [INFO] 🔄 Starting schedule process for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.862Z] [INFO] ✅ Successfully recovered cycle job for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.863Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:32:45.863Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:32:45.863Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:32:45.863Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Added group cm7a5zl550003rcnc7jnt7bnb to scheduledGroups set (size: 1)
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Calculating next run for group cm7a5zl550003rcnc7jnt7bnb with nextCycleDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cm7a5zl550003rcnc7jnt7bnb with currentDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Cycle already started: false
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Initial nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 04:32:45 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Is nextRun in the past? false
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Final nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Initial delay: 1538834112
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Safe delay: 1538834112
[2025-05-10T04:32:45.891Z] [INFO] ⏰ Scheduling next run for group cm7a5zl550003rcnc7jnt7bnb: [object Object]
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Added group cm7a5zl550003rcnc7jnt7bnb to scheduledGroups set (size: 1)
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Calculating next run for group cm7a5zl550003rcnc7jnt7bnb with nextCycleDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cm7a5zl550003rcnc7jnt7bnb with currentDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Cycle already started: false
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Initial nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 04:32:45 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Is nextRun in the past? false
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Final nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Initial delay: 1538834112
[2025-05-10T04:32:45.888Z] [INFO] 🔍 DEBUG: Safe delay: 1538834112
[2025-05-10T04:32:45.891Z] [INFO] ⏰ Scheduling next run for group cm7a5zl550003rcnc7jnt7bnb: [object Object]
[2025-05-10T04:32:45.907Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:32:45.910Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:32:45.910Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:32:45.910Z] [INFO] 🔁 Attempting to schedule next cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.908Z] [INFO] 🔍 DEBUG: Added group cm7a5zl550003rcnc7jnt7bnb to scheduledGroups set (size: 1)
[2025-05-10T04:32:45.908Z] [INFO] 🔍 DEBUG: Calculating next run for group cm7a5zl550003rcnc7jnt7bnb with nextCycleDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.908Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cm7a5zl550003rcnc7jnt7bnb with currentDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.908Z] [INFO] 🔍 DEBUG: Cycle already started: false
[2025-05-10T04:32:45.908Z] [INFO] 🔍 DEBUG: Initial nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.908Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 04:32:45 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.908Z] [INFO] 🔍 DEBUG: Is nextRun in the past? false
[2025-05-10T04:32:45.908Z] [INFO] 🔍 DEBUG: Final nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:45.908Z] [INFO] 🔍 DEBUG: Initial delay: 1538834092
[2025-05-10T04:32:45.908Z] [INFO] 🔍 DEBUG: Safe delay: 1538834092
[2025-05-10T04:32:45.911Z] [INFO] ⏰ Scheduling next run for group cm7a5zl550003rcnc7jnt7bnb: [object Object]
[2025-05-10T04:32:45.941Z] [INFO] ✅ Logged scheduled job contribution-cm7a5zl550003rcnc7jnt7bnb-1746851565888-0 to database for recovery
[2025-05-10T04:32:45.941Z] [INFO] ✅ Logged scheduled job contribution-cm7a5zl550003rcnc7jnt7bnb-1746851565888-0 to database for recovery
[2025-05-10T04:32:45.942Z] [INFO] 🔍 DEBUG: addQueueJob called for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:32:45.942Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.942Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:32:45.942Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:32:45.942Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.942Z] [INFO] 🔍 DEBUG: addQueueJob called for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:32:45.942Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.942Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:32:45.942Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:32:45.942Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.964Z] [INFO] ✅ Logged scheduled job contribution-cm7a5zl550003rcnc7jnt7bnb-1746851565908-0 to database for recovery
[2025-05-10T04:32:45.965Z] [INFO] 🔍 DEBUG: addQueueJob called for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:32:45.965Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.965Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:32:45.965Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:32:45.965Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.980Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:32:45.980Z] [INFO] ✅ Validations passed, proceeding to schedule group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.981Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:32:45.981Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.981Z] [INFO] 🔄 Starting schedule process for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:45.987Z] [INFO] 🔍 DEBUG: Found 2 existing jobs in queue
[2025-05-10T04:32:45.987Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851565779
[2025-05-10T04:32:45.992Z] [INFO] 🔍 DEBUG: Found 2 existing jobs in queue
[2025-05-10T04:32:45.992Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851565779
[2025-05-10T04:32:46.010Z] [INFO] 🔍 DEBUG: Found 2 existing jobs in queue
[2025-05-10T04:32:46.010Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851565779
[2025-05-10T04:32:46.010Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851565779
[2025-05-10T04:32:46.010Z] [INFO] 🚀 QUEUING: Adding job for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:32:46.010Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:32:46.017Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851565779
[2025-05-10T04:32:46.017Z] [INFO] 🚀 QUEUING: Adding job for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:32:46.017Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:32:46.034Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851565779
[2025-05-10T04:32:46.035Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:32:46.034Z] [INFO] 🚀 QUEUING: Adding job for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:32:46.034Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:32:46.035Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:32:46.043Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:32:46.043Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:32:46.051Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:32:46.051Z] [INFO] 🔍 DEBUG: Added group cm7a5zl550003rcnc7jnt7bnb to scheduledGroups set (size: 1)
[2025-05-10T04:32:46.051Z] [INFO] 🔍 DEBUG: Calculating next run for group cm7a5zl550003rcnc7jnt7bnb with nextCycleDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:46.051Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cm7a5zl550003rcnc7jnt7bnb with currentDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:46.052Z] [INFO] 🔍 DEBUG: Cycle already started: false
[2025-05-10T04:32:46.052Z] [INFO] 🔍 DEBUG: Initial nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:46.052Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 04:32:46 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:46.052Z] [INFO] 🔍 DEBUG: Is nextRun in the past? false
[2025-05-10T04:32:46.052Z] [INFO] 🔍 DEBUG: Final nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:32:46.052Z] [INFO] 🔍 DEBUG: Initial delay: 1538833948
[2025-05-10T04:32:46.052Z] [INFO] 🔍 DEBUG: Safe delay: 1538833948
[2025-05-10T04:32:46.057Z] [INFO] ⏰ Scheduling next run for group cm7a5zl550003rcnc7jnt7bnb: [object Object]
[2025-05-10T04:32:46.060Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:32:46.060Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:32:46.085Z] [INFO] 📊 Queue status after adding job: 4 total jobs
[2025-05-10T04:32:46.085Z] [INFO] ✓ Confirmed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851566010 is in queue with delay 1538834112ms
[2025-05-10T04:32:46.085Z] [INFO] ✅ Scheduled next cycle for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:32:46.086Z] [INFO] ✅ Scheduled next cycles for 1 groups after recovery
[2025-05-10T04:32:46.086Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:32:46.086Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:32:46.086Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:32:46.086Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:32:46.087Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:32:46.087Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:32:46.097Z] [INFO] 📊 Queue status after adding job: 4 total jobs
[2025-05-10T04:32:46.097Z] [INFO] ✓ Confirmed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851566017 is in queue with delay 1538834112ms
[2025-05-10T04:32:46.098Z] [INFO] ✅ Scheduled next cycle for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:32:46.098Z] [INFO] ✅ Scheduled next cycles for 1 groups after recovery
[2025-05-10T04:32:46.098Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:32:46.098Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:32:46.098Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:32:46.098Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:32:46.099Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:32:46.099Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:32:46.107Z] [INFO] 📊 Queue status after adding job: 4 total jobs
[2025-05-10T04:32:46.109Z] [INFO] ✅ Logged scheduled job contribution-cm7a5zl550003rcnc7jnt7bnb-1746851566051-0 to database for recovery
[2025-05-10T04:32:46.110Z] [INFO] 🔍 DEBUG: addQueueJob called for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:32:46.110Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:46.110Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:32:46.110Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:32:46.110Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:32:46.108Z] [INFO] ✓ Confirmed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851566034 is in queue with delay 1538834092ms
[2025-05-10T04:32:46.108Z] [INFO] ✅ Scheduled next cycle for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:32:46.108Z] [INFO] ✅ Scheduled next cycles for 1 groups after recovery
[2025-05-10T04:32:46.108Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:32:46.108Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:32:46.109Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:32:46.109Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:32:46.111Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:32:46.111Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:32:46.157Z] [INFO] 🔍 DEBUG: Found 4 existing jobs in queue
[2025-05-10T04:32:46.157Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851566017
[2025-05-10T04:32:46.179Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851566017
[2025-05-10T04:32:46.179Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851566034
[2025-05-10T04:32:46.200Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851566034
[2025-05-10T04:32:46.200Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851566010
[2025-05-10T04:32:46.222Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851566010
[2025-05-10T04:32:46.222Z] [INFO] 🚀 QUEUING: Adding job for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:32:46.222Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:32:46.246Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:32:46.246Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:32:46.289Z] [INFO] 📊 Queue status after adding job: 2 total jobs
[2025-05-10T04:32:46.289Z] [INFO] ✓ Confirmed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851566222 is in queue with delay 1538833948ms
[2025-05-10T04:32:46.290Z] [INFO] ✅ Scheduled next cycle for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:32:46.290Z] [INFO] ✅ Scheduled next cycles for 1 groups after recovery
[2025-05-10T04:32:46.290Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:32:46.290Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:32:46.290Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:32:46.290Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:32:46.291Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:32:46.292Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:32:46.668Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:32:46.672Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:32:46.693Z] [ERROR] Contribution cycle failed for group cmahne9400003rczuj9f1fclj: Error: socket hang up
[2025-05-10T04:32:46.725Z] [ERROR] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 failed: Error: socket hang up
[2025-05-10T04:32:54.809Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:32:54.808Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:32:54.813Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:32:54.810Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:32:54.814Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:32:54.809Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:32:55.191Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:32:55.192Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:32:55.497Z] [INFO] Redis bclient connected
[2025-05-10T04:32:55.498Z] [INFO] Redis bclient connected
[2025-05-10T04:32:55.497Z] [INFO] Redis bclient ready
[2025-05-10T04:32:55.498Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:32:55.498Z] [INFO] Redis bclient connected
[2025-05-10T04:32:55.498Z] [INFO] Redis bclient ready
[2025-05-10T04:32:55.498Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:32:55.499Z] [INFO] Redis bclient ready
[2025-05-10T04:32:55.499Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:32:55.520Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:32:55.521Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:32:55.522Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:32:55.825Z] [INFO] Redis bclient connected
[2025-05-10T04:32:55.825Z] [INFO] Redis bclient ready
[2025-05-10T04:32:55.825Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:32:55.846Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:34:12.442Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:34:12.443Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:34:12.443Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:34:12.443Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:34:12.443Z] [INFO] Node Environment: development
[2025-05-10T04:34:12.443Z] [INFO] Hostname: de45523e7e17
[2025-05-10T04:34:12.443Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:34:12.443Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:34:12.443Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:34:12.443Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:34:12.444Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:34:12.444Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:34:12.485Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:34:12.485Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:34:12.485Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:34:12.490Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:34:12.492Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:34:12.492Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:34:12.492Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:34:12.492Z] [INFO] Node Environment: development
[2025-05-10T04:34:12.493Z] [INFO] Hostname: c8eb6a2aa004
[2025-05-10T04:34:12.493Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:34:12.493Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:34:12.493Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:34:12.493Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:34:12.494Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:34:12.494Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:34:12.530Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:34:12.530Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:34:12.531Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:34:12.552Z] [INFO] Redis bclient connected
[2025-05-10T04:34:12.552Z] [INFO] Redis bclient ready
[2025-05-10T04:34:12.554Z] [INFO] Redis client connected
[2025-05-10T04:34:12.555Z] [INFO] Redis client ready
[2025-05-10T04:34:12.557Z] [INFO] Redis subscriber connected
[2025-05-10T04:34:12.557Z] [INFO] Redis subscriber ready
[2025-05-10T04:34:12.581Z] [INFO] ✓ Redis client connected
[2025-05-10T04:34:12.589Z] [INFO] Redis subscriber connected
[2025-05-10T04:34:12.590Z] [INFO] Redis subscriber ready
[2025-05-10T04:34:12.592Z] [INFO] Redis client connected
[2025-05-10T04:34:12.592Z] [INFO] Redis client ready
[2025-05-10T04:34:12.595Z] [INFO] Redis bclient connected
[2025-05-10T04:34:12.595Z] [INFO] Redis bclient ready
[2025-05-10T04:34:12.620Z] [INFO] ✓ Redis client connected
[2025-05-10T04:34:12.625Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:34:12.625Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:34:12.625Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:34:12.626Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:34:12.672Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:34:12.672Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:34:12.672Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:34:12.672Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:34:12.701Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:34:12.701Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:34:12.701Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:34:12.661Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:34:12.662Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:34:12.662Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:34:12.662Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:34:12.662Z] [INFO] Node Environment: development
[2025-05-10T04:34:12.662Z] [INFO] Hostname: e5d03e680bc0
[2025-05-10T04:34:12.663Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:34:12.663Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:34:12.664Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:34:12.664Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:34:12.665Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:34:12.665Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:34:12.716Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:34:12.716Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:34:12.716Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:34:12.749Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:34:12.749Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:34:12.749Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:34:12.771Z] [INFO] Redis subscriber connected
[2025-05-10T04:34:12.771Z] [INFO] Redis subscriber ready
[2025-05-10T04:34:12.773Z] [INFO] Redis client connected
[2025-05-10T04:34:12.773Z] [INFO] Redis client ready
[2025-05-10T04:34:12.775Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:34:12.775Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:34:12.775Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:34:12.776Z] [INFO] Redis bclient connected
[2025-05-10T04:34:12.776Z] [INFO] Redis bclient ready
[2025-05-10T04:34:12.798Z] [INFO] ✓ Redis client connected
[2025-05-10T04:34:12.778Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:34:12.778Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:34:12.778Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:34:12.778Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:34:12.778Z] [INFO] Node Environment: development
[2025-05-10T04:34:12.778Z] [INFO] Hostname: 81cd194bcdaa
[2025-05-10T04:34:12.779Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:34:12.779Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:34:12.779Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:34:12.779Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:34:12.780Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:34:12.780Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:34:12.813Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:34:12.813Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:34:12.813Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:34:12.817Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:34:12.817Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:34:12.817Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:34:12.844Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:34:12.844Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:34:12.844Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:34:12.845Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:34:12.848Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:34:12.848Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:34:12.848Z] [INFO] ✓ All queues operational
[2025-05-10T04:34:12.848Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:34:12.848Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:34:12.849Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:34:12.849Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:34:12.849Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:34:12.867Z] [INFO] Redis client connected
[2025-05-10T04:34:12.867Z] [INFO] Redis client ready
[2025-05-10T04:34:12.869Z] [INFO] Redis bclient connected
[2025-05-10T04:34:12.869Z] [INFO] Redis bclient ready
[2025-05-10T04:34:12.871Z] [INFO] Redis subscriber connected
[2025-05-10T04:34:12.871Z] [INFO] Redis subscriber ready
[2025-05-10T04:34:12.885Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:34:12.885Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:34:12.885Z] [INFO] ✓ All queues operational
[2025-05-10T04:34:12.885Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:34:12.885Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:34:12.885Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:34:12.886Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:34:12.886Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:34:12.894Z] [INFO] ✓ Redis client connected
[2025-05-10T04:34:12.911Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:34:12.911Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:34:12.911Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:34:12.911Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:34:12.911Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:34:12.912Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:34:12.912Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:34:12.916Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 waiting
[2025-05-10T04:34:12.916Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 waiting
[2025-05-10T04:34:12.927Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:34:12.927Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:34:12.927Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:34:12.935Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:34:12.936Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:34:12.936Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:34:12.936Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:34:12.936Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:34:12.936Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:34:12.937Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:34:12.938Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:34:12.939Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:34:12.939Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:34:12.939Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:34:12.994Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:34:12.994Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:34:12.994Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:34:13.013Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:34:13.013Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:34:13.013Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:34:13.063Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:34:13.063Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:34:13.063Z] [INFO] ✓ All queues operational
[2025-05-10T04:34:13.064Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:34:13.064Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:34:13.064Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:34:13.064Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:34:13.065Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:34:13.084Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:34:13.085Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:34:13.085Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:34:13.111Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:34:13.111Z] [INFO] 🔍 Checking for stuck jobs in all queues...
[2025-05-10T04:34:13.151Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:34:13.151Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:34:13.151Z] [INFO] ✓ All queues operational
[2025-05-10T04:34:13.152Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:34:13.152Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:34:13.152Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:34:13.152Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:34:13.153Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:34:13.160Z] [INFO] Found 3 total jobs across all queues
[2025-05-10T04:34:13.162Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:34:13.160Z] [INFO] Found 0 potentially stuck jobs
[2025-05-10T04:34:13.160Z] [INFO] ✅ Recovery check complete: 0/0 stuck jobs reprocessed
[2025-05-10T04:34:13.160Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:34:13.160Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:34:13.160Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:34:13.160Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:34:13.161Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:34:13.162Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:34:13.174Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:34:13.185Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:34:13.199Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:34:13.209Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:34:13.210Z] [INFO] 🔍 Checking for stuck jobs in all queues...
[2025-05-10T04:34:13.266Z] [INFO] Found 3 total jobs across all queues
[2025-05-10T04:34:13.266Z] [INFO] Found 0 potentially stuck jobs
[2025-05-10T04:34:13.267Z] [INFO] ✅ Recovery check complete: 0/0 stuck jobs reprocessed
[2025-05-10T04:34:13.267Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:34:13.267Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:34:13.267Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:34:13.267Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:34:13.267Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:34:13.268Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:34:13.322Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:34:13.322Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:34:13.345Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:34:13.345Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:34:13.364Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:34:13.387Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:34:13.391Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:34:13.410Z] [INFO] Removing 1 existing contribution jobs to prevent duplicates
[2025-05-10T04:34:13.414Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:34:13.434Z] [INFO] Processing recovery for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:34:13.435Z] [ERROR] Error clearing existing contribution jobs: TypeError: Cannot read properties of null (reading 'data')
[2025-05-10T04:34:13.435Z] [INFO] Group cm7a5zl550003rcnc7jnt7bnb:  [object Object]
[2025-05-10T04:34:13.435Z] [INFO] Processing recovery for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:34:13.436Z] [INFO] Group cm7a5zl550003rcnc7jnt7bnb:  [object Object]
[2025-05-10T04:34:13.492Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:34:13.514Z] [INFO] ✅ Successfully recovered cycle job for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.514Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:34:13.514Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:34:13.514Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:34:13.515Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:34:13.515Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:34:13.517Z] [INFO] ✅ Successfully recovered cycle job for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.517Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:34:13.517Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:34:13.517Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:34:13.518Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:34:13.558Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:34:13.561Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:34:13.562Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:34:13.562Z] [INFO] 🔁 Attempting to schedule next cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.566Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:34:13.566Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:34:13.566Z] [INFO] 🔁 Attempting to schedule next cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.579Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:34:13.591Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:34:13.636Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:34:13.636Z] [INFO] Removing 2 existing contribution jobs to prevent duplicates
[2025-05-10T04:34:13.636Z] [INFO] ✅ Validations passed, proceeding to schedule group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.636Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:34:13.636Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.636Z] [INFO] 🔄 Starting schedule process for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.641Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:34:13.641Z] [INFO] ✅ Validations passed, proceeding to schedule group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.641Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:34:13.641Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.641Z] [INFO] 🔄 Starting schedule process for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.644Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:34:13.661Z] [INFO] Processing recovery for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:34:13.661Z] [INFO] Group cm7a5zl550003rcnc7jnt7bnb:  [object Object]
[2025-05-10T04:34:13.667Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:34:13.700Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:34:13.708Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:34:13.708Z] [INFO] 🔍 DEBUG: Added group cm7a5zl550003rcnc7jnt7bnb to scheduledGroups set (size: 1)
[2025-05-10T04:34:13.708Z] [INFO] 🔍 DEBUG: Calculating next run for group cm7a5zl550003rcnc7jnt7bnb with nextCycleDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.708Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cm7a5zl550003rcnc7jnt7bnb with currentDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.709Z] [INFO] 🔍 DEBUG: Cycle already started: false
[2025-05-10T04:34:13.709Z] [INFO] 🔍 DEBUG: Initial nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.709Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 04:34:13 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.709Z] [INFO] 🔍 DEBUG: Is nextRun in the past? false
[2025-05-10T04:34:13.709Z] [INFO] 🔍 DEBUG: Final nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.709Z] [INFO] 🔍 DEBUG: Initial delay: 1538746291
[2025-05-10T04:34:13.709Z] [INFO] 🔍 DEBUG: Safe delay: 1538746291
[2025-05-10T04:34:13.713Z] [INFO] ⏰ Scheduling next run for group cm7a5zl550003rcnc7jnt7bnb: [object Object]
[2025-05-10T04:34:13.717Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:34:13.718Z] [INFO] 🔍 DEBUG: Added group cm7a5zl550003rcnc7jnt7bnb to scheduledGroups set (size: 1)
[2025-05-10T04:34:13.718Z] [INFO] 🔍 DEBUG: Calculating next run for group cm7a5zl550003rcnc7jnt7bnb with nextCycleDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.718Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cm7a5zl550003rcnc7jnt7bnb with currentDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.718Z] [INFO] 🔍 DEBUG: Cycle already started: false
[2025-05-10T04:34:13.718Z] [INFO] 🔍 DEBUG: Initial nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.718Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 04:34:13 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.718Z] [INFO] 🔍 DEBUG: Is nextRun in the past? false
[2025-05-10T04:34:13.718Z] [INFO] 🔍 DEBUG: Final nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.718Z] [INFO] 🔍 DEBUG: Initial delay: 1538746282
[2025-05-10T04:34:13.718Z] [INFO] 🔍 DEBUG: Safe delay: 1538746282
[2025-05-10T04:34:13.722Z] [INFO] ⏰ Scheduling next run for group cm7a5zl550003rcnc7jnt7bnb: [object Object]
[2025-05-10T04:34:13.740Z] [INFO] ✅ Successfully recovered cycle job for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.740Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:34:13.740Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:34:13.740Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:34:13.741Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:34:13.747Z] [INFO] Removing 1 existing contribution jobs to prevent duplicates
[2025-05-10T04:34:13.765Z] [INFO] ✅ Logged scheduled job contribution-cm7a5zl550003rcnc7jnt7bnb-1746851653708-0 to database for recovery
[2025-05-10T04:34:13.766Z] [INFO] 🔍 DEBUG: addQueueJob called for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:34:13.766Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.766Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:34:13.766Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:34:13.766Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.772Z] [INFO] Processing recovery for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:34:13.775Z] [INFO] ✅ Logged scheduled job contribution-cm7a5zl550003rcnc7jnt7bnb-1746851653718-0 to database for recovery
[2025-05-10T04:34:13.772Z] [INFO] Group cm7a5zl550003rcnc7jnt7bnb:  [object Object]
[2025-05-10T04:34:13.775Z] [INFO] 🔍 DEBUG: addQueueJob called for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:34:13.775Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.775Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:34:13.776Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:34:13.776Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.790Z] [INFO] 🔍 DEBUG: Found 0 existing jobs in queue
[2025-05-10T04:34:13.791Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:34:13.791Z] [INFO] 🚀 QUEUING: Adding job for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:34:13.791Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:34:13.791Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:34:13.791Z] [INFO] 🔁 Attempting to schedule next cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.799Z] [INFO] 🔍 DEBUG: Found 0 existing jobs in queue
[2025-05-10T04:34:13.799Z] [INFO] 🚀 QUEUING: Adding job for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:34:13.799Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:34:13.815Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:34:13.815Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:34:13.825Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:34:13.825Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:34:13.851Z] [INFO] ✅ Successfully recovered cycle job for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.851Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:34:13.851Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:34:13.851Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:34:13.852Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:34:13.862Z] [INFO] 📊 Queue status after adding job: 3 total jobs
[2025-05-10T04:34:13.863Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:34:13.863Z] [INFO] ✓ Confirmed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851653791 is in queue with delay 1538746291ms
[2025-05-10T04:34:13.863Z] [INFO] ✅ Scheduled next cycle for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:34:13.863Z] [INFO] ✅ Scheduled next cycles for 1 groups after recovery
[2025-05-10T04:34:13.863Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:34:13.863Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:34:13.864Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:34:13.864Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:34:13.865Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:34:13.865Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:34:13.864Z] [INFO] ✅ Validations passed, proceeding to schedule group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.865Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:34:13.865Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.865Z] [INFO] 🔄 Starting schedule process for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.871Z] [INFO] 📊 Queue status after adding job: 3 total jobs
[2025-05-10T04:34:13.872Z] [INFO] ✓ Confirmed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851653799 is in queue with delay 1538746282ms
[2025-05-10T04:34:13.872Z] [INFO] ✅ Scheduled next cycle for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:34:13.872Z] [INFO] ✅ Scheduled next cycles for 1 groups after recovery
[2025-05-10T04:34:13.872Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:34:13.872Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:34:13.872Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:34:13.872Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:34:13.873Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:34:13.873Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:34:13.900Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:34:13.901Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:34:13.901Z] [INFO] 🔁 Attempting to schedule next cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.941Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:34:13.941Z] [INFO] 🔍 DEBUG: Added group cm7a5zl550003rcnc7jnt7bnb to scheduledGroups set (size: 1)
[2025-05-10T04:34:13.941Z] [INFO] 🔍 DEBUG: Calculating next run for group cm7a5zl550003rcnc7jnt7bnb with nextCycleDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.942Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cm7a5zl550003rcnc7jnt7bnb with currentDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.942Z] [INFO] 🔍 DEBUG: Cycle already started: false
[2025-05-10T04:34:13.942Z] [INFO] 🔍 DEBUG: Initial nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.942Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 04:34:13 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.942Z] [INFO] 🔍 DEBUG: Is nextRun in the past? false
[2025-05-10T04:34:13.942Z] [INFO] 🔍 DEBUG: Final nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:13.942Z] [INFO] 🔍 DEBUG: Initial delay: 1538746058
[2025-05-10T04:34:13.942Z] [INFO] 🔍 DEBUG: Safe delay: 1538746058
[2025-05-10T04:34:13.947Z] [INFO] ⏰ Scheduling next run for group cm7a5zl550003rcnc7jnt7bnb: [object Object]
[2025-05-10T04:34:13.975Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:34:13.975Z] [INFO] ✅ Validations passed, proceeding to schedule group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.976Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:34:13.976Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.976Z] [INFO] 🔄 Starting schedule process for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.996Z] [INFO] ✅ Logged scheduled job contribution-cm7a5zl550003rcnc7jnt7bnb-1746851653941-0 to database for recovery
[2025-05-10T04:34:13.996Z] [INFO] 🔍 DEBUG: addQueueJob called for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:34:13.996Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:13.996Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:34:13.997Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:34:13.997Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:14.045Z] [INFO] 🔍 DEBUG: Found 3 existing jobs in queue
[2025-05-10T04:34:14.045Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851653799
[2025-05-10T04:34:14.046Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:34:14.047Z] [INFO] 🔍 DEBUG: Added group cm7a5zl550003rcnc7jnt7bnb to scheduledGroups set (size: 1)
[2025-05-10T04:34:14.047Z] [INFO] 🔍 DEBUG: Calculating next run for group cm7a5zl550003rcnc7jnt7bnb with nextCycleDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:14.047Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cm7a5zl550003rcnc7jnt7bnb with currentDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:14.047Z] [INFO] 🔍 DEBUG: Cycle already started: false
[2025-05-10T04:34:14.047Z] [INFO] 🔍 DEBUG: Initial nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:14.047Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 04:34:14 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:14.047Z] [INFO] 🔍 DEBUG: Is nextRun in the past? false
[2025-05-10T04:34:14.047Z] [INFO] 🔍 DEBUG: Final nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:34:14.047Z] [INFO] 🔍 DEBUG: Initial delay: 1538745953
[2025-05-10T04:34:14.047Z] [INFO] 🔍 DEBUG: Safe delay: 1538745953
[2025-05-10T04:34:14.049Z] [INFO] ⏰ Scheduling next run for group cm7a5zl550003rcnc7jnt7bnb: [object Object]
[2025-05-10T04:34:14.071Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851653799
[2025-05-10T04:34:14.072Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851653791
[2025-05-10T04:34:14.097Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851653791
[2025-05-10T04:34:14.097Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851653772
[2025-05-10T04:34:14.100Z] [INFO] ✅ Logged scheduled job contribution-cm7a5zl550003rcnc7jnt7bnb-1746851654047-0 to database for recovery
[2025-05-10T04:34:14.101Z] [INFO] 🔍 DEBUG: addQueueJob called for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:34:14.101Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:14.101Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:34:14.101Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:34:14.101Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:34:14.122Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851653772
[2025-05-10T04:34:14.123Z] [INFO] 🚀 QUEUING: Adding job for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:34:14.123Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:34:14.126Z] [INFO] 🔍 DEBUG: Found 0 existing jobs in queue
[2025-05-10T04:34:14.126Z] [INFO] 🚀 QUEUING: Adding job for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:34:14.126Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:34:14.150Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:34:14.150Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:34:14.153Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:34:14.153Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:34:14.200Z] [INFO] 📊 Queue status after adding job: 2 total jobs
[2025-05-10T04:34:14.199Z] [INFO] 📊 Queue status after adding job: 2 total jobs
[2025-05-10T04:34:14.200Z] [INFO] ✓ Confirmed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851654126 is in queue with delay 1538745953ms
[2025-05-10T04:34:14.200Z] [INFO] ✅ Scheduled next cycle for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:34:14.201Z] [INFO] ✅ Scheduled next cycles for 1 groups after recovery
[2025-05-10T04:34:14.201Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:34:14.201Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:34:14.201Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:34:14.201Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:34:14.202Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:34:14.202Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:34:14.199Z] [INFO] ✓ Confirmed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851654123 is in queue with delay 1538746058ms
[2025-05-10T04:34:14.200Z] [INFO] ✅ Scheduled next cycle for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:34:14.200Z] [INFO] ✅ Scheduled next cycles for 1 groups after recovery
[2025-05-10T04:34:14.200Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:34:14.202Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:34:14.202Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:34:14.202Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:34:14.203Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:34:14.203Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:34:33.012Z] [INFO] 🏁 Job started processing: contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:34:33.012Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:34:33.013Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:34:33.013Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 active
[2025-05-10T04:34:33.037Z] [INFO] 🏁 Job started processing: contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:34:33.037Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:34:33.038Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:34:33.038Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 active
[2025-05-10T04:34:33.140Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:34:33.140Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=false
[2025-05-10T04:34:33.141Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:34:33.167Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:34:33.168Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=false
[2025-05-10T04:34:33.168Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:34:34.189Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:34:34.191Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:34:34.194Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:34:34.213Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:34:34.213Z] [ERROR] Contribution cycle failed for group cmahne9400003rczuj9f1fclj: Error: socket hang up
[2025-05-10T04:34:34.218Z] [ERROR] Contribution cycle failed for group cmahne9400003rczuj9f1fclj: Error: socket hang up
[2025-05-10T04:34:34.243Z] [ERROR] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 failed: Error: socket hang up
[2025-05-10T04:34:34.247Z] [ERROR] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 failed: Error: socket hang up
[2025-05-10T04:35:09.261Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 waiting
[2025-05-10T04:35:09.265Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 waiting
[2025-05-10T04:35:12.989Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:35:12.994Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:35:13.249Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:35:13.250Z] [INFO] 🔍 Checking for stuck jobs in all queues...
[2025-05-10T04:35:13.311Z] [INFO] Found 4 total jobs across all queues
[2025-05-10T04:35:13.311Z] [INFO] Found 0 potentially stuck jobs
[2025-05-10T04:35:13.311Z] [INFO] ✅ Recovery check complete: 0/0 stuck jobs reprocessed
[2025-05-10T04:35:13.346Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:35:13.347Z] [INFO] 🔍 Checking for stuck jobs in all queues...
[2025-05-10T04:35:13.402Z] [INFO] Found 4 total jobs across all queues
[2025-05-10T04:35:13.402Z] [INFO] Found 0 potentially stuck jobs
[2025-05-10T04:35:13.402Z] [INFO] ✅ Recovery check complete: 0/0 stuck jobs reprocessed
[2025-05-10T04:35:23.433Z] [INFO] 🏁 Job started processing: contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:35:23.433Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:35:23.436Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:35:23.438Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 active
[2025-05-10T04:35:23.578Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:35:23.579Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=false
[2025-05-10T04:35:23.579Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:35:24.684Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:35:24.687Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:35:24.708Z] [ERROR] Contribution cycle failed for group cmahne9400003rczuj9f1fclj: Error: socket hang up
[2025-05-10T04:35:24.741Z] [ERROR] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 failed: Error: socket hang up
[2025-05-10T04:35:33.266Z] [INFO] 🏁 Job started processing: contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:35:33.266Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:35:33.267Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:35:33.269Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 active
[2025-05-10T04:35:33.389Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:35:33.390Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=false
[2025-05-10T04:35:33.390Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:35:34.445Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:35:34.447Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:35:34.470Z] [ERROR] Contribution cycle failed for group cmahne9400003rczuj9f1fclj: Error: socket hang up
[2025-05-10T04:35:34.508Z] [ERROR] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 failed: Error: socket hang up
[2025-05-10T04:36:12.995Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:36:13.002Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:36:13.241Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:36:13.365Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:36:39.747Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 waiting
[2025-05-10T04:36:44.572Z] [INFO] 🏁 Job started processing: contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:36:44.572Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:36:44.572Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:36:44.574Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 active
[2025-05-10T04:36:44.661Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:36:44.662Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=false
[2025-05-10T04:36:44.662Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:36:45.685Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:36:45.690Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:36:45.710Z] [ERROR] Contribution cycle failed for group cmahne9400003rczuj9f1fclj: Error: socket hang up
[2025-05-10T04:36:45.743Z] [ERROR] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049576 failed: Error: socket hang up
[2025-05-10T04:36:49.506Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 waiting
[2025-05-10T04:36:54.625Z] [ERROR] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746851049494 failed: Error: Missing process handler for job type __default__
[2025-05-10T04:37:12.996Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:37:12.996Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:37:13.240Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:37:13.350Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:37:24.586Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:37:24.586Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:37:24.587Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:37:24.587Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:37:24.592Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:37:24.593Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:37:24.719Z] [INFO] Redis bclient connected
[2025-05-10T04:37:24.719Z] [INFO] Redis bclient connected
[2025-05-10T04:37:24.719Z] [INFO] Redis bclient ready
[2025-05-10T04:37:24.719Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:37:24.719Z] [INFO] Redis bclient ready
[2025-05-10T04:37:24.720Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:37:24.720Z] [INFO] Redis bclient connected
[2025-05-10T04:37:24.720Z] [INFO] Redis bclient ready
[2025-05-10T04:37:24.720Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:37:24.741Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:37:24.745Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:37:24.746Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:37:25.139Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:37:25.141Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:37:25.744Z] [INFO] Redis bclient connected
[2025-05-10T04:37:25.745Z] [INFO] Redis bclient ready
[2025-05-10T04:37:25.745Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:37:25.765Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:37:48.346Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:37:48.348Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:37:48.348Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:37:48.349Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:37:48.349Z] [INFO] Node Environment: development
[2025-05-10T04:37:48.349Z] [INFO] Hostname: 551b2afb8355
[2025-05-10T04:37:48.350Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:37:48.350Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:37:48.350Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:37:48.350Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:37:48.350Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:37:48.350Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:37:48.384Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:37:48.384Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:37:48.384Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:37:48.383Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:37:48.383Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:37:48.383Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:37:48.384Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:37:48.384Z] [INFO] Node Environment: development
[2025-05-10T04:37:48.384Z] [INFO] Hostname: f2d3239b335b
[2025-05-10T04:37:48.387Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:37:48.387Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:37:48.387Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:37:48.387Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:37:48.387Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:37:48.387Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:37:48.422Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:37:48.423Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:37:48.423Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:37:48.440Z] [INFO] Redis client connected
[2025-05-10T04:37:48.440Z] [INFO] Redis client ready
[2025-05-10T04:37:48.443Z] [INFO] Redis bclient connected
[2025-05-10T04:37:48.443Z] [INFO] Redis bclient ready
[2025-05-10T04:37:48.445Z] [INFO] Redis subscriber connected
[2025-05-10T04:37:48.445Z] [INFO] Redis subscriber ready
[2025-05-10T04:37:48.429Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:37:48.429Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:37:48.429Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:37:48.429Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:37:48.429Z] [INFO] Node Environment: development
[2025-05-10T04:37:48.429Z] [INFO] Hostname: 4edee0d8332b
[2025-05-10T04:37:48.430Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:37:48.430Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:37:48.430Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:37:48.430Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:37:48.430Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:37:48.430Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:37:48.465Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:37:48.465Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:37:48.465Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:37:48.467Z] [INFO] ✓ Redis client connected
[2025-05-10T04:37:48.477Z] [INFO] Redis client connected
[2025-05-10T04:37:48.477Z] [INFO] Redis client ready
[2025-05-10T04:37:48.480Z] [INFO] Redis subscriber connected
[2025-05-10T04:37:48.480Z] [INFO] Redis subscriber ready
[2025-05-10T04:37:48.483Z] [INFO] Redis bclient connected
[2025-05-10T04:37:48.483Z] [INFO] Redis bclient ready
[2025-05-10T04:37:48.500Z] [INFO] ✓ Redis client connected
[2025-05-10T04:37:48.509Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:37:48.509Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:37:48.509Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:37:48.510Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:37:48.519Z] [INFO] Redis subscriber connected
[2025-05-10T04:37:48.520Z] [INFO] Redis subscriber ready
[2025-05-10T04:37:48.522Z] [INFO] Redis bclient connected
[2025-05-10T04:37:48.522Z] [INFO] Redis bclient ready
[2025-05-10T04:37:48.525Z] [INFO] Redis client connected
[2025-05-10T04:37:48.525Z] [INFO] Redis client ready
[2025-05-10T04:37:48.541Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:37:48.541Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:37:48.541Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:37:48.541Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:37:48.549Z] [INFO] ✓ Redis client connected
[2025-05-10T04:37:48.585Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:37:48.585Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:37:48.585Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:37:48.591Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:37:48.592Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:37:48.592Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:37:48.594Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:37:48.619Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:37:48.619Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:37:48.619Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:37:48.580Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:37:48.580Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:37:48.580Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:37:48.580Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:37:48.580Z] [INFO] Node Environment: development
[2025-05-10T04:37:48.580Z] [INFO] Hostname: 58c964b86f06
[2025-05-10T04:37:48.583Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:37:48.583Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:37:48.583Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:37:48.583Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:37:48.583Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:37:48.583Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:37:48.620Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:37:48.620Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:37:48.620Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:37:48.652Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:37:48.652Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:37:48.652Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:37:48.671Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:37:48.672Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:37:48.672Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:37:48.673Z] [INFO] Redis client connected
[2025-05-10T04:37:48.674Z] [INFO] Redis client ready
[2025-05-10T04:37:48.677Z] [INFO] Redis bclient connected
[2025-05-10T04:37:48.677Z] [INFO] Redis bclient ready
[2025-05-10T04:37:48.679Z] [INFO] Redis subscriber connected
[2025-05-10T04:37:48.679Z] [INFO] Redis subscriber ready
[2025-05-10T04:37:48.690Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:37:48.690Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:37:48.690Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:37:48.701Z] [INFO] ✓ Redis client connected
[2025-05-10T04:37:48.722Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:37:48.722Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:37:48.722Z] [INFO] ✓ All queues operational
[2025-05-10T04:37:48.722Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:37:48.722Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:37:48.723Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:37:48.723Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:37:48.723Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:37:48.744Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:37:48.744Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:37:48.744Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:37:48.746Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:37:48.746Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:37:48.746Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:37:48.746Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:37:48.766Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:37:48.766Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:37:48.766Z] [INFO] ✓ All queues operational
[2025-05-10T04:37:48.766Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:37:48.766Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:37:48.767Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:37:48.767Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:37:48.767Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:37:48.771Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:37:48.772Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:37:48.772Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:37:48.772Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:37:48.772Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:37:48.773Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:37:48.773Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:37:48.810Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:37:48.810Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:37:48.810Z] [INFO] ✓ All queues operational
[2025-05-10T04:37:48.810Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:37:48.810Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:37:48.811Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:37:48.811Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:37:48.811Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:37:48.819Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:37:48.821Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:37:48.821Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:37:48.821Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:37:48.819Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:37:48.819Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:37:48.819Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:37:48.819Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:37:48.820Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:37:48.821Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:37:48.861Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:37:48.861Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:37:48.861Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:37:48.861Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:37:48.861Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:37:48.862Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:37:48.862Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:37:48.890Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:37:48.890Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:37:48.890Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:37:48.960Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:37:48.960Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:37:48.960Z] [INFO] ✓ All queues operational
[2025-05-10T04:37:48.960Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:37:48.960Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:37:48.961Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:37:48.961Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:37:48.961Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:37:49.017Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:37:49.017Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:37:49.017Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:37:49.017Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:37:49.018Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:37:49.019Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:37:49.019Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:37:49.035Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:37:49.055Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:37:49.071Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:37:49.078Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:37:49.094Z] [INFO] Processing recovery for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:37:49.094Z] [INFO] Group cm7a5zl550003rcnc7jnt7bnb:  [object Object]
[2025-05-10T04:37:49.101Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:37:49.174Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:37:49.175Z] [INFO] ✅ Successfully recovered cycle job for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.175Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:37:49.183Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:37:49.197Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:37:49.204Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:37:49.204Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:37:49.204Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:37:49.204Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:37:49.205Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:37:49.227Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:37:49.234Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:37:49.240Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:37:49.240Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:37:49.248Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:37:49.249Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:37:49.249Z] [INFO] 🔁 Attempting to schedule next cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.256Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:37:49.264Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:37:49.275Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:37:49.286Z] [INFO] Removing 1 existing contribution jobs to prevent duplicates
[2025-05-10T04:37:49.310Z] [INFO] Processing recovery for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:37:49.311Z] [INFO] Group cm7a5zl550003rcnc7jnt7bnb:  [object Object]
[2025-05-10T04:37:49.322Z] [ERROR] Error clearing existing contribution jobs: TypeError: Cannot read properties of null (reading 'data')
[2025-05-10T04:37:49.322Z] [INFO] Processing recovery for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:37:49.322Z] [INFO] Group cm7a5zl550003rcnc7jnt7bnb:  [object Object]
[2025-05-10T04:37:49.345Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:37:49.345Z] [INFO] ✅ Validations passed, proceeding to schedule group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.345Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:37:49.345Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.345Z] [INFO] 🔄 Starting schedule process for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.386Z] [INFO] ✅ Successfully recovered cycle job for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.386Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:37:49.386Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:37:49.386Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:37:49.386Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:37:49.396Z] [INFO] ✅ Successfully recovered cycle job for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.396Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:37:49.396Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:37:49.396Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:37:49.396Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:37:49.399Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:37:49.414Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:37:49.414Z] [INFO] 🔍 DEBUG: Added group cm7a5zl550003rcnc7jnt7bnb to scheduledGroups set (size: 1)
[2025-05-10T04:37:49.414Z] [INFO] 🔍 DEBUG: Calculating next run for group cm7a5zl550003rcnc7jnt7bnb with nextCycleDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.415Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cm7a5zl550003rcnc7jnt7bnb with currentDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.415Z] [INFO] 🔍 DEBUG: Cycle already started: false
[2025-05-10T04:37:49.415Z] [INFO] 🔍 DEBUG: Initial nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.415Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 04:37:49 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.415Z] [INFO] 🔍 DEBUG: Is nextRun in the past? false
[2025-05-10T04:37:49.415Z] [INFO] 🔍 DEBUG: Final nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.415Z] [INFO] 🔍 DEBUG: Initial delay: 1538530585
[2025-05-10T04:37:49.415Z] [INFO] 🔍 DEBUG: Safe delay: 1538530585
[2025-05-10T04:37:49.418Z] [INFO] ⏰ Scheduling next run for group cm7a5zl550003rcnc7jnt7bnb: [object Object]
[2025-05-10T04:37:49.421Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:37:49.432Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:37:49.433Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:37:49.433Z] [INFO] 🔁 Attempting to schedule next cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.439Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:37:49.440Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:37:49.440Z] [INFO] 🔁 Attempting to schedule next cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.471Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:37:49.473Z] [INFO] ✅ Logged scheduled job contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869414-0 to database for recovery
[2025-05-10T04:37:49.473Z] [INFO] 🔍 DEBUG: addQueueJob called for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:37:49.473Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.473Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:37:49.473Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:37:49.473Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.500Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:37:49.500Z] [INFO] ✅ Validations passed, proceeding to schedule group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.500Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:37:49.500Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.500Z] [INFO] 🔄 Starting schedule process for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.518Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:37:49.518Z] [INFO] ✅ Validations passed, proceeding to schedule group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.518Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:37:49.519Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.519Z] [INFO] 🔄 Starting schedule process for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.519Z] [INFO] Removing 2 existing contribution jobs to prevent duplicates
[2025-05-10T04:37:49.519Z] [INFO] 🔍 DEBUG: Found 2 existing jobs in queue
[2025-05-10T04:37:49.519Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869322
[2025-05-10T04:37:49.544Z] [INFO] Processing recovery for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:37:49.544Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869322
[2025-05-10T04:37:49.544Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869311
[2025-05-10T04:37:49.544Z] [INFO] Group cm7a5zl550003rcnc7jnt7bnb:  [object Object]
[2025-05-10T04:37:49.567Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869311
[2025-05-10T04:37:49.567Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:37:49.567Z] [INFO] 🚀 QUEUING: Adding job for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:37:49.567Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:37:49.567Z] [INFO] 🔍 DEBUG: Added group cm7a5zl550003rcnc7jnt7bnb to scheduledGroups set (size: 1)
[2025-05-10T04:37:49.567Z] [INFO] 🔍 DEBUG: Calculating next run for group cm7a5zl550003rcnc7jnt7bnb with nextCycleDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.568Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cm7a5zl550003rcnc7jnt7bnb with currentDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.568Z] [INFO] 🔍 DEBUG: Cycle already started: false
[2025-05-10T04:37:49.568Z] [INFO] 🔍 DEBUG: Initial nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.568Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 04:37:49 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.568Z] [INFO] 🔍 DEBUG: Is nextRun in the past? false
[2025-05-10T04:37:49.568Z] [INFO] 🔍 DEBUG: Final nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.568Z] [INFO] 🔍 DEBUG: Initial delay: 1538530432
[2025-05-10T04:37:49.568Z] [INFO] 🔍 DEBUG: Safe delay: 1538530432
[2025-05-10T04:37:49.571Z] [INFO] ⏰ Scheduling next run for group cm7a5zl550003rcnc7jnt7bnb: [object Object]
[2025-05-10T04:37:49.586Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:37:49.586Z] [INFO] 🔍 DEBUG: Added group cm7a5zl550003rcnc7jnt7bnb to scheduledGroups set (size: 1)
[2025-05-10T04:37:49.587Z] [INFO] 🔍 DEBUG: Calculating next run for group cm7a5zl550003rcnc7jnt7bnb with nextCycleDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.587Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cm7a5zl550003rcnc7jnt7bnb with currentDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.587Z] [INFO] 🔍 DEBUG: Cycle already started: false
[2025-05-10T04:37:49.587Z] [INFO] 🔍 DEBUG: Initial nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.587Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 04:37:49 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.587Z] [INFO] 🔍 DEBUG: Is nextRun in the past? false
[2025-05-10T04:37:49.587Z] [INFO] 🔍 DEBUG: Final nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.587Z] [INFO] 🔍 DEBUG: Initial delay: 1538530413
[2025-05-10T04:37:49.587Z] [INFO] 🔍 DEBUG: Safe delay: 1538530413
[2025-05-10T04:37:49.590Z] [INFO] ⏰ Scheduling next run for group cm7a5zl550003rcnc7jnt7bnb: [object Object]
[2025-05-10T04:37:49.591Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:37:49.591Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:37:49.618Z] [INFO] ✅ Logged scheduled job contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869567-0 to database for recovery
[2025-05-10T04:37:49.619Z] [INFO] 🔍 DEBUG: addQueueJob called for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:37:49.619Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.619Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:37:49.619Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:37:49.619Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.620Z] [INFO] ✅ Successfully recovered cycle job for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.620Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:37:49.620Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:37:49.620Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:37:49.620Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:37:49.634Z] [INFO] 📊 Queue status after adding job: 2 total jobs
[2025-05-10T04:37:49.634Z] [INFO] ✓ Confirmed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869567 is in queue with delay 1538530585ms
[2025-05-10T04:37:49.634Z] [INFO] ✅ Scheduled next cycle for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:37:49.635Z] [INFO] ✅ Scheduled next cycles for 1 groups after recovery
[2025-05-10T04:37:49.635Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:37:49.635Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:37:49.635Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:37:49.635Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:37:49.635Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:37:49.635Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:37:49.636Z] [INFO] ✅ Logged scheduled job contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869586-0 to database for recovery
[2025-05-10T04:37:49.636Z] [INFO] 🔍 DEBUG: addQueueJob called for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:37:49.636Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.636Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:37:49.636Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:37:49.636Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.660Z] [INFO] 🔍 DEBUG: Found 2 existing jobs in queue
[2025-05-10T04:37:49.660Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869567
[2025-05-10T04:37:49.668Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:37:49.668Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:37:49.668Z] [INFO] 🔁 Attempting to schedule next cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.679Z] [INFO] 🔍 DEBUG: Found 2 existing jobs in queue
[2025-05-10T04:37:49.679Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869567
[2025-05-10T04:37:49.681Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869567
[2025-05-10T04:37:49.681Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869544
[2025-05-10T04:37:49.701Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869544
[2025-05-10T04:37:49.701Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869567
[2025-05-10T04:37:49.702Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869544
[2025-05-10T04:37:49.701Z] [INFO] 🚀 QUEUING: Adding job for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:37:49.701Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:37:49.724Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869544
[2025-05-10T04:37:49.724Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:37:49.725Z] [INFO] 🚀 QUEUING: Adding job for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:37:49.725Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:37:49.725Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:37:49.742Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:37:49.742Z] [INFO] ✅ Validations passed, proceeding to schedule group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.743Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cm7a5zl550003rcnc7jnt7bnb (attempt: 0)
[2025-05-10T04:37:49.743Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.743Z] [INFO] 🔄 Starting schedule process for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.748Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:37:49.748Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:37:49.770Z] [INFO] 📊 Queue status after adding job: 1 total jobs
[2025-05-10T04:37:49.771Z] [INFO] ✓ Confirmed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869701 is in queue with delay 1538530432ms
[2025-05-10T04:37:49.771Z] [INFO] ✅ Scheduled next cycle for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:37:49.771Z] [INFO] ✅ Scheduled next cycles for 1 groups after recovery
[2025-05-10T04:37:49.771Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:37:49.771Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:37:49.771Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:37:49.771Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:37:49.772Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:37:49.772Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:37:49.792Z] [INFO] 📊 Queue status after adding job: 2 total jobs
[2025-05-10T04:37:49.792Z] [INFO] ✓ Confirmed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869725 is in queue with delay 1538530413ms
[2025-05-10T04:37:49.792Z] [INFO] ✅ Scheduled next cycle for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:37:49.792Z] [INFO] ✅ Scheduled next cycles for 1 groups after recovery
[2025-05-10T04:37:49.792Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:37:49.792Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:37:49.792Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:37:49.793Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:37:49.793Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:37:49.794Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:37:49.815Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:37:49.816Z] [INFO] 🔍 DEBUG: Added group cm7a5zl550003rcnc7jnt7bnb to scheduledGroups set (size: 1)
[2025-05-10T04:37:49.816Z] [INFO] 🔍 DEBUG: Calculating next run for group cm7a5zl550003rcnc7jnt7bnb with nextCycleDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.816Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cm7a5zl550003rcnc7jnt7bnb with currentDate: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.816Z] [INFO] 🔍 DEBUG: Cycle already started: false
[2025-05-10T04:37:49.816Z] [INFO] 🔍 DEBUG: Initial nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.816Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 04:37:49 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.816Z] [INFO] 🔍 DEBUG: Is nextRun in the past? false
[2025-05-10T04:37:49.816Z] [INFO] 🔍 DEBUG: Final nextRun: Wed May 28 2025 00:00:00 GMT+0000 (Coordinated Universal Time)
[2025-05-10T04:37:49.816Z] [INFO] 🔍 DEBUG: Initial delay: 1538530184
[2025-05-10T04:37:49.816Z] [INFO] 🔍 DEBUG: Safe delay: 1538530184
[2025-05-10T04:37:49.820Z] [INFO] ⏰ Scheduling next run for group cm7a5zl550003rcnc7jnt7bnb: [object Object]
[2025-05-10T04:37:49.872Z] [INFO] ✅ Logged scheduled job contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869816-0 to database for recovery
[2025-05-10T04:37:49.873Z] [INFO] 🔍 DEBUG: addQueueJob called for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:37:49.873Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.873Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:37:49.873Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:37:49.873Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cm7a5zl550003rcnc7jnt7bnb
[2025-05-10T04:37:49.921Z] [INFO] 🔍 DEBUG: Found 2 existing jobs in queue
[2025-05-10T04:37:49.922Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869725
[2025-05-10T04:37:49.947Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869725
[2025-05-10T04:37:49.947Z] [INFO] ⚠️ Removing existing job for group cm7a5zl550003rcnc7jnt7bnb: contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869701
[2025-05-10T04:37:49.971Z] [INFO] ✅ Successfully removed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869701
[2025-05-10T04:37:49.972Z] [INFO] 🚀 QUEUING: Adding job for group cm7a5zl550003rcnc7jnt7bnb with options: [object Object]
[2025-05-10T04:37:49.972Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:37:50.001Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:37:50.002Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:37:50.051Z] [INFO] 📊 Queue status after adding job: 1 total jobs
[2025-05-10T04:37:50.051Z] [INFO] ✓ Confirmed job contribution-start-contribution-cm7a5zl550003rcnc7jnt7bnb-1746851869972 is in queue with delay 1538530184ms
[2025-05-10T04:37:50.052Z] [INFO] ✅ Scheduled next cycle for group cm7a5zl550003rcnc7jnt7bnb (Test)
[2025-05-10T04:37:50.052Z] [INFO] ✅ Scheduled next cycles for 1 groups after recovery
[2025-05-10T04:37:50.053Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:37:50.053Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:37:50.053Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:37:50.053Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:37:50.055Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:37:50.055Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:38:46.310Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:38:46.309Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:38:46.312Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:38:46.331Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:38:46.329Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:38:46.333Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:38:47.014Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:38:47.029Z] [INFO] Redis bclient connected
[2025-05-10T04:38:47.032Z] [INFO] Redis bclient connected
[2025-05-10T04:38:47.029Z] [INFO] Redis bclient ready
[2025-05-10T04:38:47.032Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:38:47.022Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:38:47.032Z] [INFO] Redis bclient ready
[2025-05-10T04:38:47.038Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:38:47.049Z] [INFO] Redis bclient connected
[2025-05-10T04:38:47.050Z] [INFO] Redis bclient ready
[2025-05-10T04:38:47.050Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:38:47.063Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:38:47.063Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:38:47.096Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:38:47.668Z] [INFO] Redis bclient connected
[2025-05-10T04:38:47.669Z] [INFO] Redis bclient ready
[2025-05-10T04:38:47.669Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:38:47.690Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:40:15.518Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:40:15.519Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:40:15.519Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:40:15.519Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:40:15.519Z] [INFO] Node Environment: development
[2025-05-10T04:40:15.519Z] [INFO] Hostname: f33e291ae3c3
[2025-05-10T04:40:15.520Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:40:15.520Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:40:15.520Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:40:15.520Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:40:15.521Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:40:15.521Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:40:15.555Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:40:15.555Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:40:15.555Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:40:15.612Z] [INFO] Redis client connected
[2025-05-10T04:40:15.612Z] [INFO] Redis client ready
[2025-05-10T04:40:15.614Z] [INFO] Redis bclient connected
[2025-05-10T04:40:15.614Z] [INFO] Redis bclient ready
[2025-05-10T04:40:15.618Z] [INFO] Redis subscriber connected
[2025-05-10T04:40:15.618Z] [INFO] Redis subscriber ready
[2025-05-10T04:40:15.639Z] [INFO] ✓ Redis client connected
[2025-05-10T04:40:15.643Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:40:15.643Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:40:15.643Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:40:15.643Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:40:15.643Z] [INFO] Node Environment: development
[2025-05-10T04:40:15.644Z] [INFO] Hostname: 7f098e44f486
[2025-05-10T04:40:15.644Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:40:15.644Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:40:15.644Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:40:15.644Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:40:15.645Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:40:15.645Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:40:15.680Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:40:15.680Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:40:15.680Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:40:15.685Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:40:15.685Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:40:15.685Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:40:15.686Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:40:15.682Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:40:15.683Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:40:15.683Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:40:15.683Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:40:15.683Z] [INFO] Node Environment: development
[2025-05-10T04:40:15.683Z] [INFO] Hostname: 999e48bef2d1
[2025-05-10T04:40:15.684Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:40:15.684Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:40:15.684Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:40:15.684Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:40:15.685Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:40:15.685Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:40:15.719Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:40:15.719Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:40:15.719Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:40:15.742Z] [INFO] Redis subscriber connected
[2025-05-10T04:40:15.742Z] [INFO] Redis subscriber ready
[2025-05-10T04:40:15.744Z] [INFO] Redis client connected
[2025-05-10T04:40:15.745Z] [INFO] Redis client ready
[2025-05-10T04:40:15.747Z] [INFO] Redis bclient connected
[2025-05-10T04:40:15.747Z] [INFO] Redis bclient ready
[2025-05-10T04:40:15.712Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:40:15.712Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:40:15.712Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:40:15.713Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:40:15.713Z] [INFO] Node Environment: development
[2025-05-10T04:40:15.713Z] [INFO] Hostname: 97fd3a9a9a14
[2025-05-10T04:40:15.714Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:40:15.714Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:40:15.714Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:40:15.714Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:40:15.714Z] [INFO] ✅ Queue runner loaded (TypeScript version)
[2025-05-10T04:40:15.714Z] [INFO] ✅ HivePay queue worker initialized
[2025-05-10T04:40:15.747Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:40:15.747Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:40:15.747Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:40:15.766Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:40:15.766Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:40:15.766Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:40:15.771Z] [INFO] Redis client connected
[2025-05-10T04:40:15.773Z] [INFO] ✓ Redis client connected
[2025-05-10T04:40:15.771Z] [INFO] Redis client ready
[2025-05-10T04:40:15.774Z] [INFO] Redis subscriber connected
[2025-05-10T04:40:15.774Z] [INFO] Redis subscriber ready
[2025-05-10T04:40:15.776Z] [INFO] Redis bclient connected
[2025-05-10T04:40:15.776Z] [INFO] Redis bclient ready
[2025-05-10T04:40:15.799Z] [INFO] ✓ Redis client connected
[2025-05-10T04:40:15.802Z] [INFO] Redis bclient connected
[2025-05-10T04:40:15.802Z] [INFO] Redis bclient ready
[2025-05-10T04:40:15.804Z] [INFO] Redis client connected
[2025-05-10T04:40:15.804Z] [INFO] Redis client ready
[2025-05-10T04:40:15.806Z] [INFO] Redis subscriber connected
[2025-05-10T04:40:15.806Z] [INFO] Redis subscriber ready
[2025-05-10T04:40:15.818Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:40:15.818Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:40:15.818Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:40:15.818Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:40:15.833Z] [INFO] ✓ Redis client connected
[2025-05-10T04:40:15.833Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:40:15.833Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:40:15.834Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:40:15.842Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:40:15.842Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:40:15.842Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:40:15.843Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:40:15.879Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:40:15.879Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:40:15.879Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:40:15.879Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:40:15.896Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:40:15.896Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:40:15.896Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:40:15.902Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:40:15.902Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:40:15.902Z] [INFO] ✓ All queues operational
[2025-05-10T04:40:15.902Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:40:15.902Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:40:15.903Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:40:15.903Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:40:15.903Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:40:15.917Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:40:15.917Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:40:15.918Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:40:15.950Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:40:15.951Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:40:15.951Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:40:15.951Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:40:15.951Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:40:15.952Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:40:15.952Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:40:15.956Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:40:15.957Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:40:15.957Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:40:15.966Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:40:15.966Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:40:15.966Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:40:15.986Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:40:15.986Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:40:15.986Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:40:16.027Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:40:16.028Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:40:16.028Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:40:16.039Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:40:16.040Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:40:16.040Z] [INFO] ✓ All queues operational
[2025-05-10T04:40:16.040Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:40:16.040Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:40:16.040Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:40:16.041Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:40:16.041Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:40:16.055Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:40:16.055Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:40:16.055Z] [INFO] ✓ All queues operational
[2025-05-10T04:40:16.055Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:40:16.055Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:40:16.056Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:40:16.056Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:40:16.056Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:40:16.099Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:40:16.099Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:40:16.099Z] [INFO] ✓ All queues operational
[2025-05-10T04:40:16.099Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:40:16.099Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:40:16.100Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:40:16.100Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:40:16.100Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:40:16.106Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:40:16.106Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:40:16.106Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:40:16.106Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:40:16.106Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:40:16.107Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:40:16.107Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:40:16.107Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:40:16.106Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:40:16.106Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:40:16.106Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:40:16.106Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:40:16.107Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:40:16.107Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:40:16.149Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:40:16.149Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:40:16.149Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:40:16.149Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:40:16.150Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:40:16.150Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:40:16.150Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:40:16.190Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:40:16.212Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:40:16.331Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:40:16.338Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:40:16.340Z] [INFO] Found 0 active groups with pending cycles for recovery
[2025-05-10T04:40:16.341Z] [INFO] Found 0 active groups with pending cycles for recovery
[2025-05-10T04:40:16.355Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:40:16.360Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:40:16.364Z] [INFO] ✅ Recovered 0 contribution cycle jobs
[2025-05-10T04:40:16.364Z] [INFO] ✅ Recovered 0 contribution cycle jobs
[2025-05-10T04:40:16.364Z] [INFO] ✅ Queue recovery complete: 0 total jobs recovered
[2025-05-10T04:40:16.364Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:40:16.364Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:40:16.376Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:40:16.401Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:40:16.411Z] [INFO] Found 0 active groups for next cycle scheduling
[2025-05-10T04:40:16.411Z] [INFO] ✅ Scheduled next cycles for 0 groups after recovery
[2025-05-10T04:40:16.412Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:40:16.412Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:40:16.412Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:40:16.412Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:40:16.412Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:40:16.412Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:40:16.497Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:40:16.504Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:40:16.504Z] [INFO] Found 0 active groups with pending cycles for recovery
[2025-05-10T04:40:16.505Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:40:16.519Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:40:16.527Z] [INFO] ✅ Recovered 0 contribution cycle jobs
[2025-05-10T04:40:16.528Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:40:16.528Z] [INFO] ✅ Queue recovery complete: 0 total jobs recovered
[2025-05-10T04:40:16.528Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:40:16.528Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:40:16.531Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:40:16.531Z] [INFO] ✅ Queue recovery complete: 0 total jobs recovered
[2025-05-10T04:40:16.531Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:40:16.531Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:40:16.532Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:40:16.533Z] [INFO] Found 0 active groups with pending cycles for recovery
[2025-05-10T04:40:16.556Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:40:16.559Z] [INFO] ✅ Recovered 0 contribution cycle jobs
[2025-05-10T04:40:16.559Z] [INFO] ✅ Queue recovery complete: 0 total jobs recovered
[2025-05-10T04:40:16.559Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:40:16.559Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:40:16.579Z] [INFO] Found 0 active groups for next cycle scheduling
[2025-05-10T04:40:16.579Z] [INFO] Found 0 active groups for next cycle scheduling
[2025-05-10T04:40:16.579Z] [INFO] ✅ Scheduled next cycles for 0 groups after recovery
[2025-05-10T04:40:16.579Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:40:16.580Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:40:16.580Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:40:16.580Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:40:16.580Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:40:16.580Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:40:16.579Z] [INFO] ✅ Scheduled next cycles for 0 groups after recovery
[2025-05-10T04:40:16.580Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:40:16.580Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:40:16.580Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:40:16.580Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:40:16.581Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:40:16.581Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:40:16.608Z] [INFO] Found 0 active groups for next cycle scheduling
[2025-05-10T04:40:16.608Z] [INFO] ✅ Scheduled next cycles for 0 groups after recovery
[2025-05-10T04:40:16.608Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:40:16.608Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:40:16.609Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:40:16.609Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:40:16.610Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:40:16.610Z] [INFO] 📝 Logs are being written to: /app/logs/queue.log
[2025-05-10T04:41:16.241Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:41:16.283Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:41:16.285Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:41:16.288Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:42:05.546Z] [INFO] [contribution-cycles] Job contribution-cmahne9400003rczuj9f1fclj-1746852095415-0 waiting
[2025-05-10T04:42:06.331Z] [INFO] 🏁 Job started processing: direct-contribution-cmahne9400003rczuj9f1fclj-1746852095612 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:42:06.333Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:42:06.337Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:42:06.339Z] [INFO] [contribution-cycles] Job direct-contribution-cmahne9400003rczuj9f1fclj-1746852095612 active
[2025-05-10T04:42:06.466Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:42:06.467Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=false
[2025-05-10T04:42:06.467Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:42:07.511Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:42:07.529Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:42:07.535Z] [ERROR] Contribution cycle failed for group cmahne9400003rczuj9f1fclj: Error: socket hang up
[2025-05-10T04:42:07.568Z] [ERROR] [contribution-cycles] Job direct-contribution-cmahne9400003rczuj9f1fclj-1746852095612 failed: Error: socket hang up
[2025-05-10T04:42:07.595Z] [INFO] 🏁 Job started processing: contribution-cmahne9400003rczuj9f1fclj-1746852095415-0 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:42:07.595Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:42:07.595Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:42:07.595Z] [INFO] [contribution-cycles] Job contribution-cmahne9400003rczuj9f1fclj-1746852095415-0 active
[2025-05-10T04:42:07.642Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:42:07.643Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=false
[2025-05-10T04:42:07.643Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:42:08.679Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:42:08.697Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:42:08.725Z] [ERROR] Contribution cycle failed for group cmahne9400003rczuj9f1fclj: Error: socket hang up
[2025-05-10T04:42:08.777Z] [ERROR] [contribution-cycles] Job contribution-cmahne9400003rczuj9f1fclj-1746852095415-0 failed: Error: socket hang up
[2025-05-10T04:42:12.579Z] [INFO] [contribution-cycles] Job direct-contribution-cmahne9400003rczuj9f1fclj-1746852095612 waiting
[2025-05-10T04:42:13.754Z] [INFO] [contribution-cycles] Job contribution-cmahne9400003rczuj9f1fclj-1746852095415-0 waiting
[2025-05-10T04:42:16.141Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:42:16.240Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:42:16.263Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:42:16.264Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:42:36.452Z] [INFO] 🏁 Job started processing: contribution-cmahne9400003rczuj9f1fclj-1746852095415-0 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:42:36.457Z] [INFO] 🏁 Job started processing: direct-contribution-cmahne9400003rczuj9f1fclj-1746852095612 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:42:36.458Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:42:36.461Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:42:36.463Z] [INFO] [contribution-cycles] Job contribution-cmahne9400003rczuj9f1fclj-1746852095415-0 active
[2025-05-10T04:42:36.459Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:42:36.461Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:42:36.463Z] [INFO] [contribution-cycles] Job direct-contribution-cmahne9400003rczuj9f1fclj-1746852095612 active
[2025-05-10T04:42:36.589Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:42:36.589Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:42:36.589Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=true
[2025-05-10T04:42:36.589Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:42:36.590Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=true
[2025-05-10T04:42:36.590Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:42:37.708Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:42:37.709Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:42:37.710Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:42:37.718Z] [ERROR] Failed to send contribution reminder: Error: socket hang up
[2025-05-10T04:42:37.733Z] [ERROR] Contribution cycle failed for group cmahne9400003rczuj9f1fclj: Error: socket hang up
[2025-05-10T04:42:37.733Z] [ERROR] Contribution cycle failed for group cmahne9400003rczuj9f1fclj: Error: socket hang up
[2025-05-10T04:42:37.766Z] [ERROR] [contribution-cycles] Job contribution-cmahne9400003rczuj9f1fclj-1746852095415-0 failed: Error: socket hang up
[2025-05-10T04:42:37.768Z] [ERROR] [contribution-cycles] Job direct-contribution-cmahne9400003rczuj9f1fclj-1746852095612 failed: Error: socket hang up
[2025-05-10T04:42:50.361Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:42:50.368Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:42:50.357Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:42:50.361Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:42:50.369Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:42:50.362Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:42:50.856Z] [INFO] 🛑 SIGTERM received, shutting down gracefully...
[2025-05-10T04:42:50.861Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:42:51.000Z] [INFO] Redis bclient connected
[2025-05-10T04:42:51.000Z] [INFO] Redis bclient ready
[2025-05-10T04:42:51.001Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:42:51.023Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:42:51.027Z] [INFO] Redis bclient connected
[2025-05-10T04:42:51.027Z] [INFO] Redis bclient ready
[2025-05-10T04:42:51.027Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:42:51.033Z] [INFO] Redis bclient connected
[2025-05-10T04:42:51.033Z] [INFO] Redis bclient ready
[2025-05-10T04:42:51.036Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:42:51.055Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:42:51.062Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:42:51.564Z] [INFO] Redis bclient connected
[2025-05-10T04:42:51.564Z] [INFO] Redis bclient ready
[2025-05-10T04:42:51.564Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:45:01.106Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:45:01.107Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:45:01.107Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:45:01.107Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:45:01.107Z] [INFO] Node Environment: development
[2025-05-10T04:45:01.107Z] [INFO] Hostname: Mac-2.local
[2025-05-10T04:45:01.107Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:45:01.107Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:45:01.107Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:45:01.107Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:45:01.128Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:45:01.128Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:45:01.128Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:45:01.194Z] [INFO] Redis subscriber connected
[2025-05-10T04:45:01.194Z] [INFO] Redis subscriber ready
[2025-05-10T04:45:01.197Z] [INFO] Redis client connected
[2025-05-10T04:45:01.197Z] [INFO] Redis client ready
[2025-05-10T04:45:01.199Z] [INFO] Redis bclient connected
[2025-05-10T04:45:01.199Z] [INFO] Redis bclient ready
[2025-05-10T04:45:01.221Z] [INFO] ✓ Redis client connected
[2025-05-10T04:45:01.263Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:45:01.263Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:45:01.263Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:45:01.264Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:45:01.334Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:45:01.335Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:45:01.335Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:45:01.401Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:45:01.401Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:45:01.402Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:45:01.468Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:45:01.468Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:45:01.468Z] [INFO] ✓ All queues operational
[2025-05-10T04:45:01.468Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:45:01.468Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:45:01.469Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:45:01.469Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:45:01.469Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:45:01.520Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:45:01.520Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:45:01.520Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:45:01.520Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:45:01.520Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:45:01.521Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:45:01.522Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:45:01.526Z] [INFO] [contribution-cycles] Job contribution-cmahne9400003rczuj9f1fclj-1746852095415-0 waiting
[2025-05-10T04:45:01.526Z] [INFO] [contribution-cycles] Job direct-contribution-cmahne9400003rczuj9f1fclj-1746852095612 waiting
[2025-05-10T04:45:01.526Z] [INFO] [contribution-cycles] Job contribution-cmahne9400003rczuj9f1fclj-1746852146845-0 waiting
[2025-05-10T04:45:01.777Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:45:01.800Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:45:01.957Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:45:01.978Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:45:02.019Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:45:02.065Z] [INFO] Removing 3 existing contribution jobs to prevent duplicates
[2025-05-10T04:45:02.090Z] [INFO] Processing recovery for group cmahne9400003rczuj9f1fclj (FINAL TEST)
[2025-05-10T04:45:02.090Z] [INFO] Group cmahne9400003rczuj9f1fclj:  [object Object]
[2025-05-10T04:45:02.167Z] [INFO] ✅ Successfully recovered cycle job for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:45:02.167Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:45:02.167Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:45:02.167Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:45:02.167Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:45:02.214Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:45:02.214Z] [INFO] ✅ Scheduled next cycles for 0 groups after recovery
[2025-05-10T04:45:02.214Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:45:02.214Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:45:02.214Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:45:02.214Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:45:02.215Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:45:02.215Z] [INFO] 📝 Logs are being written to: /Users/Development/CirclePay/logs/queue.log
[2025-05-10T04:45:06.945Z] [INFO] 🛑 SIGINT received, shutting down gracefully...
[2025-05-10T04:45:06.946Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:45:07.539Z] [INFO] Redis bclient connected
[2025-05-10T04:45:07.539Z] [INFO] Redis bclient ready
[2025-05-10T04:45:07.540Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:45:07.559Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:46:05.021Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:46:05.021Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:46:05.021Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:46:05.021Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:46:05.021Z] [INFO] Node Environment: development
[2025-05-10T04:46:05.021Z] [INFO] Hostname: Mac-2.local
[2025-05-10T04:46:05.021Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:46:05.021Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:46:05.021Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:46:05.021Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:46:05.042Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:46:05.042Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:46:05.042Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:46:05.095Z] [INFO] Redis client connected
[2025-05-10T04:46:05.095Z] [INFO] Redis client ready
[2025-05-10T04:46:05.098Z] [INFO] Redis bclient connected
[2025-05-10T04:46:05.098Z] [INFO] Redis bclient ready
[2025-05-10T04:46:05.100Z] [INFO] Redis subscriber connected
[2025-05-10T04:46:05.100Z] [INFO] Redis subscriber ready
[2025-05-10T04:46:05.120Z] [INFO] ✓ Redis client connected
[2025-05-10T04:46:05.164Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:46:05.164Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:46:05.164Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:46:05.164Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:46:05.235Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:46:05.235Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:46:05.235Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:46:05.302Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:46:05.303Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:46:05.303Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:46:05.372Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:46:05.372Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:46:05.372Z] [INFO] ✓ All queues operational
[2025-05-10T04:46:05.372Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:46:05.372Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:46:05.373Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:46:05.373Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:46:05.373Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:46:05.418Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:46:05.418Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:46:05.418Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:46:05.418Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:46:05.419Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:46:05.419Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:46:05.419Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:46:05.649Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:46:05.670Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:46:05.830Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:46:05.853Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:46:05.874Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:46:05.918Z] [INFO] Removing 2 existing contribution jobs to prevent duplicates
[2025-05-10T04:46:05.943Z] [INFO] Processing recovery for group cmahne9400003rczuj9f1fclj (FINAL TEST)
[2025-05-10T04:46:05.943Z] [INFO] Group cmahne9400003rczuj9f1fclj:  [object Object]
[2025-05-10T04:46:06.018Z] [INFO] ✅ Successfully recovered cycle job for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:46:06.018Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:46:06.018Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:46:06.018Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:46:06.018Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:46:06.064Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:46:06.064Z] [INFO] ✅ Scheduled next cycles for 0 groups after recovery
[2025-05-10T04:46:06.064Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:46:06.064Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:46:06.064Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:46:06.064Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:46:06.065Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:46:06.065Z] [INFO] 📝 Logs are being written to: /Users/Development/CirclePay/logs/queue.log
[2025-05-10T04:46:15.972Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746852365943 waiting
[2025-05-10T04:46:25.563Z] [ERROR] [contribution-cycles] Connection error: Error: Job direct-contribution-cmahne9400003rczuj9f1fclj-1746852365298 is not in the active state. failed
[2025-05-10T04:46:35.590Z] [INFO] 🏁 Job started processing: contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746852365943 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:46:35.591Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:46:35.593Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:46:35.594Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746852365943 active
[2025-05-10T04:46:35.708Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:46:35.708Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=false
[2025-05-10T04:46:35.708Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:46:35.919Z] [INFO] Sending contribution reminders for 2 members
[2025-05-10T04:46:37.078Z] [INFO] Contribution reminder sent to suhaybw1@gmail.com
[2025-05-10T04:46:37.078Z] [INFO] Email sent successfully to suhaybw1@gmail.com
[2025-05-10T04:46:37.095Z] [INFO] Contribution reminder sent to support@hivepay.com.au
[2025-05-10T04:46:37.095Z] [INFO] Email sent successfully to support@hivepay.com.au
[2025-05-10T04:46:37.095Z] [INFO] Email sending process completed - continuing with contribution cycle
[2025-05-10T04:46:37.095Z] [INFO] Processing cycle 1: [object Object]
[2025-05-10T04:46:37.142Z] [INFO] Skipping payee: kp_588d4df4181549e791abd1eef41be8de
[2025-05-10T04:46:38.592Z] [INFO] PaymentIntent created for user kp_5813a23edaed4d4996418141e208cf59: pi_3RN5J3D0Tog7VW7O1x3sSLso
[2025-05-10T04:46:38.738Z] [INFO] 🔍 CRITICAL: Marking member cmahne95e0005rczubg4zz5td (MoOn CaKe) as paid
[2025-05-10T04:46:38.887Z] [INFO] 🔍 Member cmahne95e0005rczubg4zz5td status: hasBeenPaid=true
[2025-05-10T04:46:38.887Z] [INFO] ✅ Successfully marked member cmahne95e0005rczubg4zz5td as paid
[2025-05-10T04:46:38.961Z] [INFO] 🔍 DEBUG: Member payment status AFTER transaction:
[2025-05-10T04:46:38.961Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=true
[2025-05-10T04:46:38.961Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:46:38.961Z] [INFO] 🔍 DEBUG: Actual unpaid members count: 1
[2025-05-10T04:46:38.961Z] [INFO] === processContributionCycle success for group=cmahne9400003rczuj9f1fclj ===

[2025-05-10T04:46:39.052Z] [INFO] 🔍 Group state after transaction: cyclesCompleted=false, cycleStarted=true, status=Active, currentMemberCycle=0, totalCycles=0
[2025-05-10T04:46:39.052Z] [INFO] 🔍 Members remaining to be paid in this cycle: 1
[2025-05-10T04:46:39.052Z] [INFO] 🔍 Unpaid members: kp_5813a23edaed4d4996418141e208cf59
[2025-05-10T04:46:39.052Z] [INFO] 🔄 1 members still need payment in current cycle - preserving cycle date
[2025-05-10T04:46:39.052Z] [INFO] 🔍 Current cycle date: Fri May 09 2025 10:00:00 GMT+1000 (Australian Eastern Standard Time)
[2025-05-10T04:46:39.052Z] [INFO] ✅ Scheduling next cycle for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:46:39.053Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cmahne9400003rczuj9f1fclj (attempt: 0)
[2025-05-10T04:46:39.053Z] [INFO] 🔁 Attempting to schedule next cycle for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:46:39.123Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:46:39.123Z] [INFO] 🔍 DEBUG: Group cmahne9400003rczuj9f1fclj has 1 unpaid members remaining
[2025-05-10T04:46:39.123Z] [INFO] 🔄 Group cmahne9400003rczuj9f1fclj cycle in progress with 1 unpaid members remaining
[2025-05-10T04:46:39.123Z] [INFO] ✅ Validations passed, proceeding to schedule group cmahne9400003rczuj9f1fclj
[2025-05-10T04:46:39.124Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cmahne9400003rczuj9f1fclj (attempt: 0)
[2025-05-10T04:46:39.124Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:46:39.124Z] [INFO] 🔄 Starting schedule process for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:46:39.197Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:46:39.197Z] [INFO] 🔍 DEBUG: Added group cmahne9400003rczuj9f1fclj to scheduledGroups set (size: 1)
[2025-05-10T04:46:39.198Z] [INFO] 🔍 DEBUG: Calculating next run for group cmahne9400003rczuj9f1fclj with nextCycleDate: Fri May 09 2025 10:00:00 GMT+1000 (Australian Eastern Standard Time)
[2025-05-10T04:46:39.198Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cmahne9400003rczuj9f1fclj with currentDate: Fri May 09 2025 10:00:00 GMT+1000 (Australian Eastern Standard Time)
[2025-05-10T04:46:39.198Z] [INFO] 🔍 DEBUG: Cycle already started: true
[2025-05-10T04:46:39.198Z] [INFO] 🔍 DEBUG: Initial nextRun: Fri May 09 2025 10:00:00 GMT+1000 (Australian Eastern Standard Time)
[2025-05-10T04:46:39.198Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 14:46:39 GMT+1000 (Australian Eastern Standard Time)
[2025-05-10T04:46:39.198Z] [INFO] 🔍 DEBUG: Is nextRun in the past? true
[2025-05-10T04:46:39.198Z] [INFO] ⏩ Setting immediate execution with buffer: 2025-05-10T04:47:09.198Z
[2025-05-10T04:46:39.198Z] [INFO] 🔍 DEBUG: Final nextRun: Sat May 10 2025 14:47:09 GMT+1000 (Australian Eastern Standard Time)
[2025-05-10T04:46:39.198Z] [INFO] 🔍 DEBUG: Initial delay: 30000
[2025-05-10T04:46:39.198Z] [INFO] 🔍 DEBUG: Safe delay: 30000
[2025-05-10T04:46:39.202Z] [INFO] ⏰ Scheduling next run for group cmahne9400003rczuj9f1fclj: [object Object]
[2025-05-10T04:46:39.251Z] [INFO] ✅ Logged scheduled job contribution-cmahne9400003rczuj9f1fclj-1746852399197-0 to database for recovery
[2025-05-10T04:46:39.255Z] [INFO] 🔍 DEBUG: addQueueJob called for group cmahne9400003rczuj9f1fclj with options: [object Object]
[2025-05-10T04:46:39.255Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:46:39.257Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:46:39.258Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:46:39.259Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:46:39.285Z] [INFO] 🔍 DEBUG: Found 0 existing jobs in queue
[2025-05-10T04:46:39.285Z] [INFO] 🚀 QUEUING: Adding job for group cmahne9400003rczuj9f1fclj with options: [object Object]
[2025-05-10T04:46:39.285Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:46:39.306Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:46:39.306Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:46:39.349Z] [INFO] 📊 Queue status after adding job: 1 total jobs
[2025-05-10T04:46:39.349Z] [INFO] ✓ Confirmed job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746852399285 is in queue with delay 30000ms
[2025-05-10T04:46:39.349Z] [INFO] 🔄 Setting up backup timer for group cmahne9400003rczuj9f1fclj (delay: 30000ms)
[2025-05-10T04:46:39.370Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746852365943 completed
[2025-05-10T04:47:05.473Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:47:09.351Z] [INFO] ⏰ Backup timer triggered for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:47:09.426Z] [INFO] ✅ Job already completed via normal queue, backup not needed
[2025-05-10T04:47:19.204Z] [INFO] 🔄 Removed group cmahne9400003rczuj9f1fclj from scheduled set after timeout
[2025-05-10T04:47:29.030Z] [INFO] [contribution-cycles] Job contribution-cmahne9400003rczuj9f1fclj-1746852418874-0 waiting
[2025-05-10T04:47:45.728Z] [INFO] 🏁 Job started processing: contribution-cmahne9400003rczuj9f1fclj-1746852418874-0 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:47:45.729Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:47:45.729Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:47:45.729Z] [INFO] [contribution-cycles] Job contribution-cmahne9400003rczuj9f1fclj-1746852418874-0 active
[2025-05-10T04:47:45.810Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:47:45.820Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=true
[2025-05-10T04:47:45.820Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:47:45.966Z] [INFO] Sending contribution reminders for 2 members
[2025-05-10T04:47:46.953Z] [INFO] Contribution reminder sent to support@hivepay.com.au
[2025-05-10T04:47:46.954Z] [INFO] Email sent successfully to support@hivepay.com.au
[2025-05-10T04:47:47.134Z] [INFO] Contribution reminder sent to suhaybw1@gmail.com
[2025-05-10T04:47:47.134Z] [INFO] Email sent successfully to suhaybw1@gmail.com
[2025-05-10T04:47:47.135Z] [INFO] Email sending process completed - continuing with contribution cycle
[2025-05-10T04:47:47.135Z] [INFO] Processing cycle 2: [object Object]
[2025-05-10T04:47:48.001Z] [INFO] PaymentIntent created for user kp_588d4df4181549e791abd1eef41be8de: pi_3RN5KBD0Tog7VW7O1PpYVpVY
[2025-05-10T04:47:48.001Z] [INFO] Skipping payee: kp_5813a23edaed4d4996418141e208cf59
[2025-05-10T04:47:48.079Z] [INFO] 🔍 CRITICAL: Marking member cmahnisrr000brczukc10gny4 (SUHAYB WALTON) as paid
[2025-05-10T04:47:48.150Z] [INFO] 🔍 Member cmahnisrr000brczukc10gny4 status: hasBeenPaid=true
[2025-05-10T04:47:48.150Z] [INFO] ✅ Successfully marked member cmahnisrr000brczukc10gny4 as paid
[2025-05-10T04:47:48.220Z] [INFO] 🔍 DEBUG: Member payment status AFTER transaction:
[2025-05-10T04:47:48.221Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=true
[2025-05-10T04:47:48.221Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=true
[2025-05-10T04:47:48.223Z] [INFO] 🔍 DEBUG: Actual unpaid members count: 0
[2025-05-10T04:47:48.223Z] [INFO] === processContributionCycle success for group=cmahne9400003rczuj9f1fclj ===

[2025-05-10T04:47:48.269Z] [INFO] 🔍 Group state after transaction: cyclesCompleted=false, cycleStarted=true, status=Active, currentMemberCycle=0, totalCycles=0
[2025-05-10T04:47:48.269Z] [INFO] 🔍 Members remaining to be paid in this cycle: 0
[2025-05-10T04:47:48.269Z] [INFO] 🔍 All members paid but cycle not marked as completed. Running finalization...
[2025-05-10T04:47:48.491Z] [INFO] Found futureCyclesJson with 1 dates
[2025-05-10T04:47:48.491Z] [INFO] 🏁 All cycles completed - no more future dates available
[2025-05-10T04:47:48.566Z] [INFO] Cycle 0 completed for group cmahne9400003rczuj9f1fclj.
[2025-05-10T04:47:48.568Z] [INFO] No more cycles scheduled - all cycles completed
[2025-05-10T04:47:48.596Z] [INFO] ✅ Scheduling next cycle for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:47:48.597Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cmahne9400003rczuj9f1fclj (attempt: 0)
[2025-05-10T04:47:48.597Z] [INFO] 🔁 Attempting to schedule next cycle for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:47:48.646Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:47:48.646Z] [INFO] ⏹️  Group cmahne9400003rczuj9f1fclj cycles already completed, skipping scheduling
[2025-05-10T04:47:48.671Z] [INFO] [contribution-cycles] Job contribution-cmahne9400003rczuj9f1fclj-1746852418874-0 completed
[2025-05-10T04:48:05.465Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:49:05.475Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:50:05.492Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:51:05.479Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:51:06.095Z] [INFO] 📊 Queue status: [object Object]
[2025-05-10T04:51:06.099Z] [INFO] 📈 Metrics Summary: [object Object]
[2025-05-10T04:52:05.483Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:53:05.477Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:54:05.486Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:55:06.189Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:55:20.749Z] [INFO] 🛑 SIGINT received, shutting down gracefully...
[2025-05-10T04:55:20.750Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:55:21.380Z] [INFO] Redis bclient connected
[2025-05-10T04:55:21.380Z] [INFO] Redis bclient ready
[2025-05-10T04:55:21.381Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:55:21.400Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:56:51.136Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:56:51.136Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:56:51.136Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:56:51.136Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:56:51.136Z] [INFO] Node Environment: development
[2025-05-10T04:56:51.136Z] [INFO] Hostname: Mac-2.local
[2025-05-10T04:56:51.136Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:56:51.136Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:56:51.137Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:56:51.137Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:56:51.157Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:56:51.157Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:56:51.157Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:56:51.210Z] [INFO] Redis client connected
[2025-05-10T04:56:51.211Z] [INFO] Redis client ready
[2025-05-10T04:56:51.213Z] [INFO] Redis subscriber connected
[2025-05-10T04:56:51.213Z] [INFO] Redis subscriber ready
[2025-05-10T04:56:51.215Z] [INFO] Redis bclient connected
[2025-05-10T04:56:51.215Z] [INFO] Redis bclient ready
[2025-05-10T04:56:51.236Z] [INFO] ✓ Redis client connected
[2025-05-10T04:56:51.279Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:56:51.279Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:56:51.279Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:56:51.280Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:56:51.349Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:56:51.349Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:56:51.349Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:56:51.415Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:56:51.415Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:56:51.415Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:56:51.486Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:56:51.486Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:56:51.486Z] [INFO] ✓ All queues operational
[2025-05-10T04:56:51.487Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:56:51.487Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:56:51.487Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:56:51.487Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:56:51.487Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:56:51.540Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:56:51.540Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:56:51.540Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:56:51.541Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:56:51.541Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:56:51.541Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:56:51.542Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:56:51.859Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:56:51.906Z] [INFO] Removing 2 existing contribution jobs to prevent duplicates
[2025-05-10T04:56:51.931Z] [INFO] Processing recovery for group cmahne9400003rczuj9f1fclj (FINAL TEST)
[2025-05-10T04:56:51.931Z] [INFO] Group cmahne9400003rczuj9f1fclj:  [object Object]
[2025-05-10T04:56:51.991Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:56:52.007Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:56:52.012Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:56:52.012Z] [INFO] ✅ Successfully recovered cycle job for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:56:52.012Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:56:52.028Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:56:52.028Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:56:52.029Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:56:52.029Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:56:52.077Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:56:52.077Z] [INFO] ✅ Scheduled next cycles for 0 groups after recovery
[2025-05-10T04:56:52.077Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:56:52.078Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:56:52.078Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:56:52.078Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:56:52.079Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:56:52.079Z] [INFO] 📝 Logs are being written to: /Users/Development/CirclePay/logs/queue.log
[2025-05-10T04:56:53.487Z] [INFO] 🛑 SIGINT received, shutting down gracefully...
[2025-05-10T04:56:53.487Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T04:56:54.084Z] [INFO] Redis bclient connected
[2025-05-10T04:56:54.084Z] [INFO] Redis bclient ready
[2025-05-10T04:56:54.084Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T04:56:54.105Z] [INFO] ✅ Redis connections closed
[2025-05-10T04:57:01.469Z] [INFO] 🚀 Queue worker starting with environment: [object Object]
[2025-05-10T04:57:01.470Z] [INFO] 📊 REDIS CONFIGURATION DETAILS:
[2025-05-10T04:57:01.470Z] [INFO] Redis URL: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:57:01.470Z] [INFO] Database URL: postgresql://****@ep-muddy-math-a71h11ow-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require
[2025-05-10T04:57:01.470Z] [INFO] Node Environment: development
[2025-05-10T04:57:01.470Z] [INFO] Hostname: Mac-2.local
[2025-05-10T04:57:01.470Z] [INFO] 📊 Initializing metrics service
[2025-05-10T04:57:01.470Z] [INFO] 🔄 Starting queue worker initialization...
[2025-05-10T04:57:01.470Z] [INFO] 🔄 Verifying environment...
[2025-05-10T04:57:01.470Z] [INFO] 🔄 Verifying Redis connection...
[2025-05-10T04:57:01.491Z] [INFO] ✅ Contribution queue connection verified
[2025-05-10T04:57:01.491Z] [INFO] ✅ Payment queue connection verified
[2025-05-10T04:57:01.491Z] [INFO] ✅ Group status queue connection verified
[2025-05-10T04:57:01.545Z] [INFO] Redis client connected
[2025-05-10T04:57:01.545Z] [INFO] Redis client ready
[2025-05-10T04:57:01.547Z] [INFO] Redis bclient connected
[2025-05-10T04:57:01.547Z] [INFO] Redis bclient ready
[2025-05-10T04:57:01.549Z] [INFO] Redis subscriber connected
[2025-05-10T04:57:01.549Z] [INFO] Redis subscriber ready
[2025-05-10T04:57:01.571Z] [INFO] ✓ Redis client connected
[2025-05-10T04:57:01.614Z] [INFO] ✅ Redis connection successful
[2025-05-10T04:57:01.614Z] [INFO] ✅ Using Upstash Redis - persistence is managed by the service
[2025-05-10T04:57:01.614Z] [INFO] 🔄 Initializing queues...
[2025-05-10T04:57:01.615Z] [INFO] Attempting to initialize Contribution queue...
[2025-05-10T04:57:01.684Z] [INFO] Contribution queue metrics: [object Object]
[2025-05-10T04:57:01.684Z] [INFO] ✓ Contribution queue ready
[2025-05-10T04:57:01.684Z] [INFO] Attempting to initialize Payment queue...
[2025-05-10T04:57:01.752Z] [INFO] Payment queue metrics: [object Object]
[2025-05-10T04:57:01.752Z] [INFO] ✓ Payment queue ready
[2025-05-10T04:57:01.752Z] [INFO] Attempting to initialize Group Status queue...
[2025-05-10T04:57:01.820Z] [INFO] Group Status queue metrics: [object Object]
[2025-05-10T04:57:01.820Z] [INFO] ✓ Group Status queue ready
[2025-05-10T04:57:01.820Z] [INFO] ✓ All queues operational
[2025-05-10T04:57:01.820Z] [INFO] ✅ Queue add methods patched for unique job IDs
[2025-05-10T04:57:01.820Z] [INFO] 🔄 Configuring queue events...
[2025-05-10T04:57:01.821Z] [INFO] ✅ Queue event listeners configured
[2025-05-10T04:57:01.821Z] [INFO] 🔄 Registering queue processors...
[2025-05-10T04:57:01.821Z] [INFO] ✅ Queue processors registered
[2025-05-10T04:57:01.872Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:57:01.872Z] [INFO] Scheduling health checks every 60 seconds
[2025-05-10T04:57:01.873Z] [INFO] 🔄 Running job recovery to ensure no jobs are missed...
[2025-05-10T04:57:01.873Z] [INFO] 🔄 Starting queue job recovery from database state...
[2025-05-10T04:57:01.873Z] [INFO] 🔄 Recovering contribution cycle jobs...
[2025-05-10T04:57:01.874Z] [INFO] 🔄 Recovering failed payment jobs...
[2025-05-10T04:57:01.874Z] [INFO] 🔄 Recovering group status jobs...
[2025-05-10T04:57:01.955Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746853011931 waiting
[2025-05-10T04:57:02.156Z] [INFO] Found 0 failed payments eligible for retry
[2025-05-10T04:57:02.180Z] [INFO] ✅ Recovered 0 payment retry jobs
[2025-05-10T04:57:02.353Z] [INFO] Found 0 paused groups for recovery
[2025-05-10T04:57:02.376Z] [INFO] ✅ Recovered 0 group status jobs
[2025-05-10T04:57:02.396Z] [INFO] Found 1 active groups with pending cycles for recovery
[2025-05-10T04:57:02.442Z] [INFO] Removing 1 existing contribution jobs to prevent duplicates
[2025-05-10T04:57:02.466Z] [INFO] Processing recovery for group cmahne9400003rczuj9f1fclj (FINAL TEST)
[2025-05-10T04:57:02.467Z] [INFO] Group cmahne9400003rczuj9f1fclj:  [object Object]
[2025-05-10T04:57:02.546Z] [INFO] ✅ Successfully recovered cycle job for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:57:02.546Z] [INFO] ✅ Recovered 1 contribution cycle jobs
[2025-05-10T04:57:02.546Z] [INFO] ✅ Queue recovery complete: 1 total jobs recovered
[2025-05-10T04:57:02.546Z] [INFO] ✅ Recovery complete: [object Object]
[2025-05-10T04:57:02.546Z] [INFO] 🔄 Scheduling next cycles after recovery...
[2025-05-10T04:57:02.595Z] [INFO] Found 1 active groups for next cycle scheduling
[2025-05-10T04:57:02.596Z] [INFO] ✅ Scheduled next cycles for 0 groups after recovery
[2025-05-10T04:57:02.596Z] [INFO] Environment Status: [object Object]
[2025-05-10T04:57:02.596Z] [INFO] ✅ Queue worker is fully operational
[2025-05-10T04:57:02.596Z] [INFO] ✅ Queue worker initialization complete!
[2025-05-10T04:57:02.596Z] [INFO] 📅 Scheduling regular recovery checks (every 15 minutes)
[2025-05-10T04:57:02.599Z] [INFO] 🏁 Queue worker is now running and processing jobs
[2025-05-10T04:57:02.599Z] [INFO] 📝 Logs are being written to: /Users/Development/CirclePay/logs/queue.log
[2025-05-10T04:57:12.492Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746853022467 waiting
[2025-05-10T04:57:22.017Z] [ERROR] [contribution-cycles] Connection error: Error: Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746853011931 is not in the active state. failed
[2025-05-10T04:57:32.042Z] [INFO] 🏁 Job started processing: contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746853022467 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:57:32.043Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:57:32.044Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:57:32.045Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746853022467 active
[2025-05-10T04:57:32.169Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:57:32.169Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=true
[2025-05-10T04:57:32.169Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:57:32.391Z] [INFO] Sending contribution reminders for 2 members
[2025-05-10T04:57:33.578Z] [INFO] Contribution reminder sent to support@hivepay.com.au
[2025-05-10T04:57:33.579Z] [INFO] Email sent successfully to support@hivepay.com.au
[2025-05-10T04:57:33.579Z] [INFO] Contribution reminder sent to suhaybw1@gmail.com
[2025-05-10T04:57:33.579Z] [INFO] Email sent successfully to suhaybw1@gmail.com
[2025-05-10T04:57:33.579Z] [INFO] Email sending process completed - continuing with contribution cycle
[2025-05-10T04:57:33.580Z] [INFO] Processing cycle 2: [object Object]
[2025-05-10T04:57:34.819Z] [INFO] PaymentIntent created for user kp_588d4df4181549e791abd1eef41be8de: pi_3RN5TdD0Tog7VW7O1MFwtCnZ
[2025-05-10T04:57:34.820Z] [INFO] Skipping payee: kp_5813a23edaed4d4996418141e208cf59
[2025-05-10T04:57:34.962Z] [INFO] 🔍 CRITICAL: Marking member cmahnisrr000brczukc10gny4 (SUHAYB WALTON) as paid
[2025-05-10T04:57:35.110Z] [INFO] 🔍 Member cmahnisrr000brczukc10gny4 status: hasBeenPaid=true
[2025-05-10T04:57:35.111Z] [INFO] ✅ Successfully marked member cmahnisrr000brczukc10gny4 as paid
[2025-05-10T04:57:35.185Z] [INFO] 🔍 DEBUG: Member payment status AFTER transaction:
[2025-05-10T04:57:35.186Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=true
[2025-05-10T04:57:35.186Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=true
[2025-05-10T04:57:35.186Z] [INFO] 🔍 DEBUG: Actual unpaid members count: 0
[2025-05-10T04:57:35.186Z] [INFO] === processContributionCycle success for group=cmahne9400003rczuj9f1fclj ===

[2025-05-10T04:57:35.287Z] [INFO] 🔍 Group state after transaction: cyclesCompleted=false, cycleStarted=true, status=Active, currentMemberCycle=0, totalCycles=0
[2025-05-10T04:57:35.287Z] [INFO] 🔍 Members remaining to be paid in this cycle: 0
[2025-05-10T04:57:35.287Z] [INFO] 🔍 All members paid but cycle not marked as completed. Running finalization...
[2025-05-10T04:57:35.512Z] [INFO] Found futureCyclesJson with 2 dates
[2025-05-10T04:57:35.512Z] [INFO] 📅 Advancing to next cycle date: Fri May 16 2025 10:00:00 GMT+1000 (Australian Eastern Standard Time)
[2025-05-10T04:57:36.732Z] [ERROR] Contribution cycle failed for group cmahne9400003rczuj9f1fclj: PrismaClientUnknownRequestError: 
Invalid `tx.groupMembership.updateMany()` invocation in
/Users/Development/CirclePay/src/lib/queue/processors.ts:139:30

  136 
  137 // Reset all members' hasBeenPaid status for the next cycle
  138 if (nextCycleDate) {
→ 139   await tx.groupMembership.updateMany(
Error occurred during query execution:
ConnectorError(ConnectorError { user_facing_error: None, kind: QueryError(PostgresError { code: "40P01", message: "deadlock detected", severity: "ERROR", detail: Some("Process 7034 waits for ShareLock on transaction 751757; blocked by process 811.\nProcess 811 waits for ShareLock on transaction 751758; blocked by process 7034."), column: None, hint: Some("See server log for query details.") }), transient: false })
[2025-05-10T04:57:36.764Z] [ERROR] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746853022467 failed: PrismaClientUnknownRequestError: 
Invalid `tx.groupMembership.updateMany()` invocation in
/Users/Development/CirclePay/src/lib/queue/processors.ts:139:30

  136 
  137 // Reset all members' hasBeenPaid status for the next cycle
  138 if (nextCycleDate) {
→ 139   await tx.groupMembership.updateMany(
Error occurred during query execution:
ConnectorError(ConnectorError { user_facing_error: None, kind: QueryError(PostgresError { code: "40P01", message: "deadlock detected", severity: "ERROR", detail: Some("Process 7034 waits for ShareLock on transaction 751757; blocked by process 811.\nProcess 811 waits for ShareLock on transaction 751758; blocked by process 7034."), column: None, hint: Some("See server log for query details.") }), transient: false })
[2025-05-10T04:57:41.760Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746853022467 waiting
[2025-05-10T04:57:42.030Z] [INFO] 🏁 Job started processing: contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746853022467 (start-contribution) for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:57:42.031Z] [INFO] Processing contribution for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:57:42.031Z] [INFO] 
=== processContributionCycle started for group=cmahne9400003rczuj9f1fclj ===
[2025-05-10T04:57:42.031Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746853022467 active
[2025-05-10T04:57:42.084Z] [INFO] 🔍 DEBUG: Member payment status BEFORE transaction:
[2025-05-10T04:57:42.084Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=false
[2025-05-10T04:57:42.084Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:57:42.210Z] [INFO] Sending contribution reminders for 2 members
[2025-05-10T04:57:43.402Z] [INFO] Contribution reminder sent to support@hivepay.com.au
[2025-05-10T04:57:43.402Z] [INFO] Email sent successfully to support@hivepay.com.au
[2025-05-10T04:57:44.574Z] [INFO] Contribution reminder sent to suhaybw1@gmail.com
[2025-05-10T04:57:44.574Z] [INFO] Email sent successfully to suhaybw1@gmail.com
[2025-05-10T04:57:44.574Z] [INFO] Email sending process completed - continuing with contribution cycle
[2025-05-10T04:57:44.575Z] [INFO] Processing cycle 1: [object Object]
[2025-05-10T04:57:44.601Z] [INFO] Skipping payee: kp_588d4df4181549e791abd1eef41be8de
[2025-05-10T04:57:44.627Z] [INFO] Payment exists for user kp_5813a23edaed4d4996418141e208cf59, cycle 1
[2025-05-10T04:57:44.776Z] [INFO] 🔄 Updated group to mark cycle as started
[2025-05-10T04:57:44.777Z] [INFO] 🔍 CRITICAL: Marking member cmahne95e0005rczubg4zz5td (MoOn CaKe) as paid
[2025-05-10T04:57:44.849Z] [INFO] 🔍 Member cmahne95e0005rczubg4zz5td status: hasBeenPaid=true
[2025-05-10T04:57:44.849Z] [INFO] ✅ Successfully marked member cmahne95e0005rczubg4zz5td as paid
[2025-05-10T04:57:44.921Z] [INFO] 🔍 DEBUG: Member payment status AFTER transaction:
[2025-05-10T04:57:44.922Z] [INFO] Member MoOn CaKe (cmahne95e0005rczubg4zz5td): hasBeenPaid=true
[2025-05-10T04:57:44.922Z] [INFO] Member SUHAYB WALTON (cmahnisrr000brczukc10gny4): hasBeenPaid=false
[2025-05-10T04:57:44.922Z] [INFO] 🔍 DEBUG: Actual unpaid members count: 1
[2025-05-10T04:57:44.922Z] [INFO] === processContributionCycle success for group=cmahne9400003rczuj9f1fclj ===

[2025-05-10T04:57:44.972Z] [INFO] 🔍 Group state after transaction: cyclesCompleted=false, cycleStarted=true, status=Active, currentMemberCycle=1, totalCycles=1
[2025-05-10T04:57:44.972Z] [INFO] 🔍 Members remaining to be paid in this cycle: 1
[2025-05-10T04:57:44.972Z] [INFO] 🔍 Unpaid members: kp_5813a23edaed4d4996418141e208cf59
[2025-05-10T04:57:44.972Z] [INFO] 🔄 1 members still need payment in current cycle - preserving cycle date
[2025-05-10T04:57:44.972Z] [INFO] 🔍 Current cycle date: Fri May 16 2025 10:00:00 GMT+1000 (Australian Eastern Standard Time)
[2025-05-10T04:57:44.972Z] [INFO] ✅ Scheduling next cycle for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:57:44.973Z] [INFO] 🔍 DEBUG: scheduleNextCycle called for group cmahne9400003rczuj9f1fclj (attempt: 0)
[2025-05-10T04:57:44.973Z] [INFO] 🔁 Attempting to schedule next cycle for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:57:45.052Z] [INFO] 🔍 DEBUG: Group state in scheduleNextCycle: [object Object]
[2025-05-10T04:57:45.053Z] [INFO] 🔍 DEBUG: Group cmahne9400003rczuj9f1fclj has 1 unpaid members remaining
[2025-05-10T04:57:45.053Z] [INFO] 🔄 Group cmahne9400003rczuj9f1fclj cycle in progress with 1 unpaid members remaining
[2025-05-10T04:57:45.053Z] [INFO] ✅ Validations passed, proceeding to schedule group cmahne9400003rczuj9f1fclj
[2025-05-10T04:57:45.054Z] [INFO] 🔍 DEBUG: scheduleContributionCycle called for group cmahne9400003rczuj9f1fclj (attempt: 0)
[2025-05-10T04:57:45.054Z] [INFO] 🔥 CRITICAL PATH: Scheduling contribution cycle for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:57:45.054Z] [INFO] 🔄 Starting schedule process for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:57:45.131Z] [INFO] 🔍 DEBUG: Group state from database: [object Object]
[2025-05-10T04:57:45.132Z] [INFO] 🔍 DEBUG: Added group cmahne9400003rczuj9f1fclj to scheduledGroups set (size: 1)
[2025-05-10T04:57:45.133Z] [INFO] 🔍 DEBUG: Calculating next run for group cmahne9400003rczuj9f1fclj with nextCycleDate: Fri May 16 2025 10:00:00 GMT+1000 (Australian Eastern Standard Time)
[2025-05-10T04:57:45.133Z] [INFO] 🔍 DEBUG: calculateAndSetNextRun for group cmahne9400003rczuj9f1fclj with currentDate: Fri May 16 2025 10:00:00 GMT+1000 (Australian Eastern Standard Time)
[2025-05-10T04:57:45.133Z] [INFO] 🔍 DEBUG: Cycle already started: true
[2025-05-10T04:57:45.133Z] [INFO] 🔍 DEBUG: Initial nextRun: Fri May 16 2025 10:00:00 GMT+1000 (Australian Eastern Standard Time)
[2025-05-10T04:57:45.133Z] [INFO] 🔍 DEBUG: Current time: Sat May 10 2025 14:57:45 GMT+1000 (Australian Eastern Standard Time)
[2025-05-10T04:57:45.133Z] [INFO] 🔍 DEBUG: Is nextRun in the past? false
[2025-05-10T04:57:45.134Z] [INFO] 🔍 DEBUG: Final nextRun: Fri May 16 2025 10:00:00 GMT+1000 (Australian Eastern Standard Time)
[2025-05-10T04:57:45.134Z] [INFO] 🔍 DEBUG: Initial delay: 500534866
[2025-05-10T04:57:45.134Z] [INFO] 🔍 DEBUG: Safe delay: 500534866
[2025-05-10T04:57:45.137Z] [INFO] ⏰ Scheduling next run for group cmahne9400003rczuj9f1fclj: [object Object]
[2025-05-10T04:57:45.189Z] [INFO] ✅ Logged scheduled job contribution-cmahne9400003rczuj9f1fclj-1746853065133-0 to database for recovery
[2025-05-10T04:57:45.191Z] [INFO] 🔍 DEBUG: addQueueJob called for group cmahne9400003rczuj9f1fclj with options: [object Object]
[2025-05-10T04:57:45.191Z] [INFO] 🔥 CRITICAL PATH: Queue job attempt for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:57:45.191Z] [INFO] 🔍 Redis URL in use: redis://****@diverse-stingray-16842.upstash.io:6379
[2025-05-10T04:57:45.192Z] [INFO] 🔍 DEBUG: Contribution queue ready check: [object Object]
[2025-05-10T04:57:45.192Z] [INFO] 🔍 DEBUG: Getting existing jobs for group cmahne9400003rczuj9f1fclj
[2025-05-10T04:57:45.218Z] [INFO] 🔍 DEBUG: Found 0 existing jobs in queue
[2025-05-10T04:57:45.218Z] [INFO] 🚀 QUEUING: Adding job for group cmahne9400003rczuj9f1fclj with options: [object Object]
[2025-05-10T04:57:45.218Z] [INFO] Queue instance details: [object Object]
[2025-05-10T04:57:45.243Z] [INFO] ✅ Successfully queued job: [object Object]
[2025-05-10T04:57:45.243Z] [INFO] 🔍 DEBUG: Verifying job was added to queue
[2025-05-10T04:57:45.288Z] [INFO] 📊 Queue status after adding job: 1 total jobs
[2025-05-10T04:57:45.288Z] [INFO] ✓ Confirmed job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746853065218 is in queue with delay 500534866ms
[2025-05-10T04:57:45.312Z] [INFO] [contribution-cycles] Job contribution-start-contribution-cmahne9400003rczuj9f1fclj-1746853022467 completed
[2025-05-10T04:58:01.919Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T04:59:01.925Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T05:00:01.926Z] [INFO] 🔍 Queue Health Check: [object Object]
[2025-05-10T05:00:13.757Z] [INFO] 🛑 SIGINT received, shutting down gracefully...
[2025-05-10T05:00:13.758Z] [INFO] 🛑 Initiating graceful shutdown of queues...
[2025-05-10T05:00:14.365Z] [INFO] Redis bclient connected
[2025-05-10T05:00:14.365Z] [INFO] Redis bclient ready
[2025-05-10T05:00:14.365Z] [INFO] ✅ All queues gracefully closed
[2025-05-10T05:00:14.386Z] [INFO] ✅ Redis connections closed
